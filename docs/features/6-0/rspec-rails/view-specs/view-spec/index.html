<!DOCTYPE html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"><![endif]-->
<!--[if IE 7]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if IE 8]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]<!--><html class="no-js" lang="en"><!--<![endif]--><head><meta charset="UTF-8" /><meta content="width=device-width, initial-scale=1" name="viewport" /><meta property="og:title" /><meta content="https://rspec.info/features/6-0/rspec-rails/view-specs/view-spec/" property="og:url" /><meta content="https://rspec.info/images/logo_ogp.png" property="og:image" /><meta content="summary" name="twitter:card" /><meta content="@rspec" name="twitter:site" /><title></title><link href="/stylesheets/pages/features.css" rel="stylesheet" /><link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet" type="text/css" /><link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro" rel="stylesheet" type="text/css" /><link href="https://fonts.googleapis.com/css?family=Inconsolata" rel="stylesheet" type="text/css" /><link href="/blog/feed.xml" rel="alternate" type="application/atom+xml" /></head><body class="features"><header><nav><h1><img src="/images/logo.png" alt="Logo" /><a href="/">RSpec</a></h1><input class="hamburger-toggle" type="checkbox" /><div class="hamburger-icon"><div class="bar"></div><div class="bar"></div><div class="bar"></div></div><ul class="menu"><li><a href="/about">About</a></li><li><a href="/documentation">Documentation</a></li><li><a href="/blog">Blog</a></li><li><a href="/upgrading-from-rspec-2">Upgrade</a></li><li><a href="/help">Get Help</a></li><li><a href="/contributing">Contributing</a></li></ul></nav></header><nav class="top-nav-bar" role="navigation"><ul><li>Library:</li><li><a class="title" href="/features/6-0/rspec-rails">RSpec Rails</a><ul aria-haspopup="true" aria-label="submenu"><li><a href="/features/3-13/rspec-core">RSpec Core</a></li><li><a href="/features/3-13/rspec-expectations">RSpec Expectations</a></li><li><a href="/features/3-13/rspec-mocks">RSpec Mocks</a></li><li class="current"><a href="/features/6-0/rspec-rails">RSpec Rails</a></li></ul></li><li>Version:</li><li><a class="title" href="/features/6-0/rspec-rails">6.0</a><ul aria-haspopup="true" aria-label="submenu"><li class="current"><a href="/features/6-0/rspec-rails">6.0</a></li><li><a href="/features/6-1/rspec-rails">6.1</a></li></ul></li></ul></nav><section><nav><ul><li><a href="/features/6-0/rspec-rails/Transactions/">Transactions</a></li><li><a href="/features/6-0/rspec-rails/directory-structure/">Directory structure</a></li><li><a href="/features/6-0/rspec-rails/backtrace-filtering/">Backtrace filtering</a></li><li><a href="/features/6-0/rspec-rails/model-specs/">Model specs</a><ul><li><a href="/features/6-0/rspec-rails/model-specs/transactional-examples/"> Transactional examples</a></li><li><a href="/features/6-0/rspec-rails/model-specs/verified-doubles/"> Using verified doubles</a></li></ul></li><li><a href="/features/6-0/rspec-rails/controller-specs/">Controller specs</a><ul><li><a href="/features/6-0/rspec-rails/controller-specs/cookies/"> Cookies</a></li><li><a href="/features/6-0/rspec-rails/controller-specs/controller-spec/"> Controller specs</a></li><li><a href="/features/6-0/rspec-rails/controller-specs/isolation-from-views/"> Views are stubbed by default</a></li><li><a href="/features/6-0/rspec-rails/controller-specs/render-views/"> Using `render_views`</a></li><li><a href="/features/6-0/rspec-rails/controller-specs/anonymous-controller/"> Using an anonymous controller</a></li><li><a href="/features/6-0/rspec-rails/controller-specs/bypass-rescue/"> Using `bypass_rescue`</a></li><li><a href="/features/6-0/rspec-rails/controller-specs/engine-routes/"> Engine routes for controllers</a></li><li><a href="/features/6-0/rspec-rails/controller-specs/setting-request-headers/"> Setting request headers</a></li></ul></li><li><a href="/features/6-0/rspec-rails/matchers/">Matchers</a><ul><li><a href="/features/6-0/rspec-rails/matchers/new-record-matcher/"> `be_a_new` matcher</a></li><li><a href="/features/6-0/rspec-rails/matchers/render-template-matcher/"> `render_template` matcher</a></li><li><a href="/features/6-0/rspec-rails/matchers/redirect-to-matcher/"> `redirect_to` matcher</a></li><li><a href="/features/6-0/rspec-rails/matchers/have-performed-job-matcher/"> `have_performed_job` matcher</a></li><li><a href="/features/6-0/rspec-rails/matchers/have-been-performed-matcher/"> `have_been_performed` matcher</a></li><li><a href="/features/6-0/rspec-rails/matchers/have-broadcasted-matcher/"> `have_broadcasted_to` matcher</a></li><li><a href="/features/6-0/rspec-rails/matchers/have-enqueued-job-matcher/"> `have_enqueued_job` matcher</a></li><li><a href="/features/6-0/rspec-rails/matchers/have-stream-from-matcher/"> `have_stream_from` matcher</a></li><li><a href="/features/6-0/rspec-rails/matchers/have-enqueued-mail-matcher/"> `have_enqueued_mail` matcher</a></li><li><a href="/features/6-0/rspec-rails/matchers/have-http-status-matcher/"> `have_http_status` matcher</a></li><li><a href="/features/6-0/rspec-rails/matchers/relation-match-array/"> ActiveRecord::Relation match array</a></li><li><a href="/features/6-0/rspec-rails/matchers/have-been-enqueued-matcher/"> `have_been_enqueued` matcher</a></li></ul></li><li><a href="/features/6-0/rspec-rails/request-specs/">Request specs</a><ul><li><a href="/features/6-0/rspec-rails/request-specs/request-spec/"> Request specs</a></li></ul></li><li><a href="/features/6-0/rspec-rails/feature-specs/">Feature specs</a><ul><li><a href="/features/6-0/rspec-rails/feature-specs/feature-spec/"> Feature specs</a></li></ul></li><li><a href="/features/6-0/rspec-rails/view-specs/">View specs</a><ul class="open"><li><a href="/features/6-0/rspec-rails/view-specs/view-spec/"> View specs</a></li><li><a href="/features/6-0/rspec-rails/view-specs/stub-template/"> Using `stub_template`</a></li><li><a href="/features/6-0/rspec-rails/view-specs/inferred-controller-path/"> View specs infer controller&#39;s path and action</a></li></ul></li><li><a href="/features/6-0/rspec-rails/helper-specs/">Helper specs</a><ul><li><a href="/features/6-0/rspec-rails/helper-specs/helper-spec/"> Helper specs</a></li></ul></li><li><a href="/features/6-0/rspec-rails/mailer-specs/">Mailer specs</a><ul><li><a href="/features/6-0/rspec-rails/mailer-specs/url-helpers/"> URL helpers in mailer examples</a></li><li><a href="/features/6-0/rspec-rails/mailer-specs/mailer-spec/"> Mailer specs</a></li></ul></li><li><a href="/features/6-0/rspec-rails/routing-specs/">Routing specs</a><ul><li><a href="/features/6-0/rspec-rails/routing-specs/route-to-matcher/"> `route_to` matcher</a></li><li><a href="/features/6-0/rspec-rails/routing-specs/be-routable-matcher/"> `be_routable` matcher</a></li><li><a href="/features/6-0/rspec-rails/routing-specs/named-routes/"> Using named routes</a></li><li><a href="/features/6-0/rspec-rails/routing-specs/engine-routes/"> Using engine routes</a></li></ul></li><li><a href="/features/6-0/rspec-rails/upgrade/">Upgrade</a></li><li><a href="/features/6-0/rspec-rails/generator-specs/">Generator specs</a><ul><li><a href="/features/6-0/rspec-rails/generator-specs/mailer-specs/"> Mailer generator spec</a></li><li><a href="/features/6-0/rspec-rails/generator-specs/channel-specs/"> Channel generator spec</a></li><li><a href="/features/6-0/rspec-rails/generator-specs/system-specs/"> System generator spec</a></li><li><a href="/features/6-0/rspec-rails/generator-specs/controller-specs/"> Controller generator spec</a></li><li><a href="/features/6-0/rspec-rails/generator-specs/view-specs/"> View generator spec</a></li><li><a href="/features/6-0/rspec-rails/generator-specs/helper-specs/"> Helper generator spec</a></li><li><a href="/features/6-0/rspec-rails/generator-specs/mailbox-specs/"> Mailbox generator spec</a></li><li><a href="/features/6-0/rspec-rails/generator-specs/integration-specs/"> Integration generator spec</a></li><li><a href="/features/6-0/rspec-rails/generator-specs/generator-specs/"> Generator spec</a></li><li><a href="/features/6-0/rspec-rails/generator-specs/request-specs/"> Request generator spec</a></li><li><a href="/features/6-0/rspec-rails/generator-specs/job-specs/"> Job generator spec</a></li><li><a href="/features/6-0/rspec-rails/generator-specs/feature-specs/"> Feature generator spec</a></li></ul></li><li><a href="/features/6-0/rspec-rails/GettingStarted/">Gettingstarted</a></li><li><a href="/features/6-0/rspec-rails/channel-specs/">Channel specs</a><ul><li><a href="/features/6-0/rspec-rails/channel-specs/channel-spec/"> Channel specs</a></li></ul></li><li><a href="/features/6-0/rspec-rails/file-fixture/">File fixture</a></li><li><a href="/features/6-0/rspec-rails/mailbox-specs/">Mailbox specs</a><ul><li><a href="/features/6-0/rspec-rails/mailbox-specs/mailbox-spec/"> Action mailbox specs</a></li></ul></li><li><a href="/features/6-0/rspec-rails/system-specs/">System specs</a><ul><li><a href="/features/6-0/rspec-rails/system-specs/system-specs/"> System specs</a></li></ul></li><li><a href="/features/6-0/rspec-rails/Generators/">Generators</a></li><li><a href="/features/6-0/rspec-rails/job-specs/">Job specs</a><ul><li><a href="/features/6-0/rspec-rails/job-specs/job-spec/"> Job specs</a></li></ul></li></ul></nav><article><h1>View specs</h1>

<p>View specs are marked by <code>type: :view</code>
  or if you have set <code>config.infer_spec_type_from_file_location!</code>
  by placing them in <code>spec/views</code>.</p>

<p>Use them to test the content of view templates
  without invoking a specific controller.
  They generally follow three steps:</p>
<div class="highlight"><pre class="highlight ruby"><code>  <span class="n">assign</span><span class="p">(</span><span class="ss">:widget</span><span class="p">,</span> <span class="no">Widget</span><span class="p">.</span><span class="nf">new</span><span class="p">)</span>  <span class="c1"># sets @widget = Widget.new in the view template</span>

  <span class="n">render</span>

  <span class="n">expect</span><span class="p">(</span><span class="n">rendered</span><span class="p">).</span><span class="nf">to</span> <span class="n">match</span><span class="p">(</span><span class="sr">/text/</span><span class="p">)</span>
</code></pre></div>
<ol>
<li><p>Use the <code>assign</code> method to set instance variables in the view.</p></li>
<li><p>Use the <code>render</code> method to render the view.</p></li>
<li><p>Set expectations against the resulting rendered template.</p></li>
</ol>

<h2>View specs render the described view file</h2>

<p><em>Given</em> a file named &ldquo;spec/views/widgets/index.html.erb_spec.rb&rdquo; with:</p>
<div class="highlight"><pre class="highlight ruby"><code><span class="nb">require</span> <span class="s2">"rails_helper"</span>

<span class="no">RSpec</span><span class="p">.</span><span class="nf">describe</span> <span class="s2">"widgets/index"</span> <span class="k">do</span>
  <span class="n">it</span> <span class="s2">"displays all the widgets"</span> <span class="k">do</span>
    <span class="n">assign</span><span class="p">(</span><span class="ss">:widgets</span><span class="p">,</span> <span class="p">[</span>
      <span class="no">Widget</span><span class="p">.</span><span class="nf">create!</span><span class="p">(</span><span class="ss">:name</span> <span class="o">=&gt;</span> <span class="s2">"slicer"</span><span class="p">),</span>
      <span class="no">Widget</span><span class="p">.</span><span class="nf">create!</span><span class="p">(</span><span class="ss">:name</span> <span class="o">=&gt;</span> <span class="s2">"dicer"</span><span class="p">)</span>
    <span class="p">])</span>

    <span class="n">render</span>

    <span class="n">expect</span><span class="p">(</span><span class="n">rendered</span><span class="p">).</span><span class="nf">to</span> <span class="n">match</span> <span class="sr">/slicer/</span>
    <span class="n">expect</span><span class="p">(</span><span class="n">rendered</span><span class="p">).</span><span class="nf">to</span> <span class="n">match</span> <span class="sr">/dicer/</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div>
<p><em>When</em> I run <code>rspec spec/views</code></p>

<p><em>Then</em> the examples should all pass.</p>

<h2>View specs can have before block and nesting</h2>

<p><em>Given</em> a file named &ldquo;spec/views/widgets/index.html.erb_spec.rb&rdquo; with:</p>
<div class="highlight"><pre class="highlight ruby"><code><span class="nb">require</span> <span class="s2">"rails_helper"</span>

<span class="no">RSpec</span><span class="p">.</span><span class="nf">describe</span> <span class="s2">"widgets/index"</span> <span class="k">do</span>

  <span class="n">context</span> <span class="s2">"with 2 widgets"</span> <span class="k">do</span>
    <span class="n">before</span><span class="p">(</span><span class="ss">:each</span><span class="p">)</span> <span class="k">do</span>
      <span class="n">assign</span><span class="p">(</span><span class="ss">:widgets</span><span class="p">,</span> <span class="p">[</span>
        <span class="no">Widget</span><span class="p">.</span><span class="nf">create!</span><span class="p">(</span><span class="ss">:name</span> <span class="o">=&gt;</span> <span class="s2">"slicer"</span><span class="p">),</span>
        <span class="no">Widget</span><span class="p">.</span><span class="nf">create!</span><span class="p">(</span><span class="ss">:name</span> <span class="o">=&gt;</span> <span class="s2">"dicer"</span><span class="p">)</span>
      <span class="p">])</span>
    <span class="k">end</span>

    <span class="n">it</span> <span class="s2">"displays both widgets"</span> <span class="k">do</span>
      <span class="n">render</span>

      <span class="n">expect</span><span class="p">(</span><span class="n">rendered</span><span class="p">).</span><span class="nf">to</span> <span class="n">match</span> <span class="sr">/slicer/</span>
      <span class="n">expect</span><span class="p">(</span><span class="n">rendered</span><span class="p">).</span><span class="nf">to</span> <span class="n">match</span> <span class="sr">/dicer/</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div>
<p><em>When</em> I run <code>rspec spec/views</code></p>

<p><em>Then</em> the examples should all pass.</p>

<h2>View specs can explicitly render templates</h2>

<p><em>Given</em> a file named &ldquo;spec/views/widgets/widget.html.erb_spec.rb&rdquo; with:</p>
<div class="highlight"><pre class="highlight ruby"><code><span class="nb">require</span> <span class="s2">"rails_helper"</span>

<span class="no">RSpec</span><span class="p">.</span><span class="nf">describe</span> <span class="s2">"rendering the widget template"</span> <span class="k">do</span>
  <span class="n">it</span> <span class="s2">"displays the widget"</span> <span class="k">do</span>
    <span class="n">assign</span><span class="p">(</span><span class="ss">:widget</span><span class="p">,</span> <span class="no">Widget</span><span class="p">.</span><span class="nf">create!</span><span class="p">(</span><span class="ss">:name</span> <span class="o">=&gt;</span> <span class="s2">"slicer"</span><span class="p">))</span>

    <span class="n">render</span> <span class="ss">:template</span> <span class="o">=&gt;</span> <span class="s2">"widgets/widget"</span>

    <span class="n">expect</span><span class="p">(</span><span class="n">rendered</span><span class="p">).</span><span class="nf">to</span> <span class="n">match</span> <span class="sr">/slicer/</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div>
<p><em>And</em> a file named &ldquo;app/views/widgets/widget.html.erb&rdquo; with:</p>
<div class="highlight"><pre class="highlight plaintext"><code>&lt;h2&gt;&lt;%= @widget.name %&gt;&lt;/h2&gt;
</code></pre></div>
<p><em>When</em> I run <code>rspec spec/views</code></p>

<p><em>Then</em> the examples should all pass.</p>

<h2>View specs can render templates in layouts</h2>

<p><em>Given</em> a file named &ldquo;spec/views/widgets/widget.html.erb_spec.rb&rdquo; with:</p>
<div class="highlight"><pre class="highlight ruby"><code><span class="nb">require</span> <span class="s2">"rails_helper"</span>

<span class="no">RSpec</span><span class="p">.</span><span class="nf">describe</span> <span class="s2">"rendering the widget template"</span> <span class="k">do</span>
  <span class="n">context</span> <span class="s2">"with the inventory layout"</span> <span class="k">do</span>
    <span class="n">it</span> <span class="s2">"displays the widget"</span> <span class="k">do</span>
      <span class="n">assign</span><span class="p">(</span><span class="ss">:widget</span><span class="p">,</span> <span class="no">Widget</span><span class="p">.</span><span class="nf">create!</span><span class="p">(</span><span class="ss">:name</span> <span class="o">=&gt;</span> <span class="s2">"slicer"</span><span class="p">))</span>

      <span class="n">render</span> <span class="ss">:template</span> <span class="o">=&gt;</span> <span class="s2">"widgets/widget"</span><span class="p">,</span> <span class="ss">:layout</span> <span class="o">=&gt;</span> <span class="s2">"layouts/inventory"</span>

      <span class="n">expect</span><span class="p">(</span><span class="n">rendered</span><span class="p">).</span><span class="nf">to</span> <span class="n">match</span> <span class="sr">/slicer/</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div>
<p><em>And</em> a file named &ldquo;app/views/widgets/widget.html.erb&rdquo; with:</p>
<div class="highlight"><pre class="highlight plaintext"><code>&lt;h2&gt;&lt;%= @widget.name %&gt;&lt;/h2&gt;
</code></pre></div>
<p><em>And</em> a file named &ldquo;app/views/layouts/inventory.html.erb&rdquo; with:</p>
<div class="highlight"><pre class="highlight plaintext"><code>&lt;%= yield %&gt;
</code></pre></div>
<p><em>When</em> I run <code>rspec spec/views</code></p>

<p><em>Then</em> the examples should all pass.</p>

<h2>View specs can have description that includes the format and handler</h2>

<p><em>Given</em> a file named &ldquo;spec/views/widgets/widget.xml.erb_spec.rb&rdquo; with:</p>
<div class="highlight"><pre class="highlight ruby"><code><span class="nb">require</span> <span class="s2">"rails_helper"</span>

<span class="no">RSpec</span><span class="p">.</span><span class="nf">describe</span> <span class="s2">"widgets/widget.html.erb"</span> <span class="k">do</span>
  <span class="n">it</span> <span class="s2">"renders the HTML template"</span> <span class="k">do</span>
    <span class="n">render</span>

    <span class="n">expect</span><span class="p">(</span><span class="n">rendered</span><span class="p">).</span><span class="nf">to</span> <span class="n">match</span> <span class="sr">/HTML/</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="no">RSpec</span><span class="p">.</span><span class="nf">describe</span> <span class="s2">"widgets/widget.xml.erb"</span> <span class="k">do</span>
  <span class="n">it</span> <span class="s2">"renders the XML template"</span> <span class="k">do</span>
    <span class="n">render</span>

    <span class="n">expect</span><span class="p">(</span><span class="n">rendered</span><span class="p">).</span><span class="nf">to</span> <span class="n">match</span> <span class="sr">/XML/</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div>
<p><em>And</em> a file named &ldquo;app/views/widgets/widget.html.erb&rdquo; with:</p>
<div class="highlight"><pre class="highlight plaintext"><code>HTML
</code></pre></div>
<p><em>And</em> a file named &ldquo;app/views/widgets/widget.xml.erb&rdquo; with:</p>
<div class="highlight"><pre class="highlight plaintext"><code>XML
</code></pre></div>
<p><em>When</em> I run <code>rspec spec/views</code></p>

<p><em>Then</em> the examples should all pass.</p>

<h2>View specs can render locals in a partial</h2>

<p><em>Given</em> a file named &ldquo;spec/views/widgets/<em>widget.html.erb</em>spec.rb&rdquo; with:</p>
<div class="highlight"><pre class="highlight ruby"><code><span class="nb">require</span> <span class="s2">"rails_helper"</span>

<span class="no">RSpec</span><span class="p">.</span><span class="nf">describe</span> <span class="s2">"rendering locals in a partial"</span> <span class="k">do</span>
  <span class="n">it</span> <span class="s2">"displays the widget"</span> <span class="k">do</span>
    <span class="n">widget</span> <span class="o">=</span> <span class="no">Widget</span><span class="p">.</span><span class="nf">create!</span><span class="p">(</span><span class="ss">:name</span> <span class="o">=&gt;</span> <span class="s2">"slicer"</span><span class="p">)</span>

    <span class="n">render</span> <span class="ss">:partial</span> <span class="o">=&gt;</span> <span class="s2">"widgets/widget"</span><span class="p">,</span> <span class="ss">:locals</span> <span class="o">=&gt;</span> <span class="p">{</span><span class="ss">:widget</span> <span class="o">=&gt;</span> <span class="n">widget</span><span class="p">}</span>

    <span class="n">expect</span><span class="p">(</span><span class="n">rendered</span><span class="p">).</span><span class="nf">to</span> <span class="n">match</span> <span class="sr">/slicer/</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div>
<p><em>And</em> a file named &ldquo;app/views/widgets/_widget.html.erb&rdquo; with:</p>
<div class="highlight"><pre class="highlight plaintext"><code>&lt;h3&gt;&lt;%= widget.name %&gt;&lt;/h3&gt;
</code></pre></div>
<p><em>When</em> I run <code>rspec spec/views</code></p>

<p><em>Then</em> the examples should all pass.</p>

<h2>View specs can render locals in an implicit partial</h2>

<p><em>Given</em> a file named &ldquo;spec/views/widgets/<em>widget.html.erb</em>spec.rb&rdquo; with:</p>
<div class="highlight"><pre class="highlight ruby"><code><span class="nb">require</span> <span class="s2">"rails_helper"</span>

<span class="no">RSpec</span><span class="p">.</span><span class="nf">describe</span> <span class="s2">"rendering locals in a partial"</span> <span class="k">do</span>
  <span class="n">it</span> <span class="s2">"displays the widget"</span> <span class="k">do</span>
    <span class="n">widget</span> <span class="o">=</span> <span class="no">Widget</span><span class="p">.</span><span class="nf">create!</span><span class="p">(</span><span class="ss">:name</span> <span class="o">=&gt;</span> <span class="s2">"slicer"</span><span class="p">)</span>

    <span class="n">render</span> <span class="s2">"widgets/widget"</span><span class="p">,</span> <span class="ss">:widget</span> <span class="o">=&gt;</span> <span class="n">widget</span>

    <span class="n">expect</span><span class="p">(</span><span class="n">rendered</span><span class="p">).</span><span class="nf">to</span> <span class="n">match</span> <span class="sr">/slicer/</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div>
<p><em>And</em> a file named &ldquo;app/views/widgets/_widget.html.erb&rdquo; with:</p>
<div class="highlight"><pre class="highlight plaintext"><code>&lt;h3&gt;&lt;%= widget.name %&gt;&lt;/h3&gt;
</code></pre></div>
<p><em>When</em> I run <code>rspec spec/views</code></p>

<p><em>Then</em> the examples should all pass.</p>

<h2>View specs can render text</h2>

<p><em>Given</em> a file named &ldquo;spec/views/widgets/direct.html.erb_spec.rb&rdquo; with:</p>
<div class="highlight"><pre class="highlight ruby"><code><span class="nb">require</span> <span class="s2">"rails_helper"</span>

<span class="no">RSpec</span><span class="p">.</span><span class="nf">describe</span> <span class="s2">"rendering text directly"</span> <span class="k">do</span>
  <span class="n">it</span> <span class="s2">"displays the given text"</span> <span class="k">do</span>

    <span class="n">render</span> <span class="ss">:plain</span> <span class="o">=&gt;</span> <span class="s2">"This is directly rendered"</span>

    <span class="n">expect</span><span class="p">(</span><span class="n">rendered</span><span class="p">).</span><span class="nf">to</span> <span class="n">match</span> <span class="sr">/directly rendered/</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div>
<p><em>When</em> I run <code>rspec spec/views</code></p>

<p><em>Then</em> the examples should all pass.</p>

<h2>View specs can stub a helper method</h2>

<p><em>Given</em> a file named &ldquo;app/helpers/application_helper.rb&rdquo; with:</p>
<div class="highlight"><pre class="highlight ruby"><code><span class="k">module</span> <span class="nn">ApplicationHelper</span>
  <span class="k">def</span> <span class="nf">admin?</span>
    <span class="kp">false</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div>
<p><em>And</em> a file named &ldquo;app/views/secrets/index.html.erb&rdquo; with:</p>
<div class="highlight"><pre class="highlight plaintext"><code>&lt;%- if admin? %&gt;
  &lt;h1&gt;Secret admin area&lt;/h1&gt;
&lt;%- end %&gt;
</code></pre></div>
<p><em>And</em> a file named &ldquo;spec/views/secrets/index.html.erb_spec.rb&rdquo; with:</p>
<div class="highlight"><pre class="highlight ruby"><code><span class="nb">require</span> <span class="s1">'rails_helper'</span>

<span class="no">RSpec</span><span class="p">.</span><span class="nf">describe</span> <span class="s1">'secrets/index'</span> <span class="k">do</span>
  <span class="n">before</span> <span class="k">do</span>
    <span class="n">allow</span><span class="p">(</span><span class="n">view</span><span class="p">).</span><span class="nf">to</span> <span class="n">receive</span><span class="p">(</span><span class="ss">:admin?</span><span class="p">).</span><span class="nf">and_return</span><span class="p">(</span><span class="kp">true</span><span class="p">)</span>
  <span class="k">end</span>

  <span class="n">it</span> <span class="s1">'checks for admin access'</span> <span class="k">do</span>
    <span class="n">render</span>
    <span class="n">expect</span><span class="p">(</span><span class="n">rendered</span><span class="p">).</span><span class="nf">to</span> <span class="n">match</span> <span class="sr">/Secret admin area/</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div>
<p><em>When</em> I run <code>rspec spec/views/secrets</code></p>

<p><em>Then</em> the examples should all pass.</p>

<h2>View specs use symbols for keys in <code>request.path_parameters</code> to match Rails style</h2>

<p><em>Given</em> a file named &ldquo;spec/views/widgets/index.html.erb_spec.rb&rdquo; with:</p>
<div class="highlight"><pre class="highlight ruby"><code><span class="nb">require</span> <span class="s2">"rails_helper"</span>

<span class="no">RSpec</span><span class="p">.</span><span class="nf">describe</span> <span class="s2">"controller.request.path_parameters"</span> <span class="k">do</span>
  <span class="n">it</span> <span class="s2">"matches the Rails environment by using symbols for keys"</span> <span class="k">do</span>
    <span class="p">[</span><span class="ss">:controller</span><span class="p">,</span> <span class="ss">:action</span><span class="p">].</span><span class="nf">each</span> <span class="p">{</span> <span class="o">|</span><span class="n">k</span><span class="o">|</span> <span class="n">expect</span><span class="p">(</span><span class="n">controller</span><span class="p">.</span><span class="nf">request</span><span class="p">.</span><span class="nf">path_parameters</span><span class="p">.</span><span class="nf">keys</span><span class="p">).</span><span class="nf">to</span> <span class="kp">include</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="p">}</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div>
<p><em>When</em> I run <code>rspec spec/views</code></p>

<p><em>Then</em> the examples should all pass.</p>

<h2>View spec actions that do not require extra parameters have <code>request.fullpath</code> set</h2>

<p><em>Given</em> a file named &ldquo;spec/views/widgets/index.html.erb_spec.rb&rdquo; with:</p>
<div class="highlight"><pre class="highlight ruby"><code>  <span class="nb">require</span> <span class="s2">"rails_helper"</span>

  <span class="no">RSpec</span><span class="p">.</span><span class="nf">describe</span> <span class="s2">"widgets/index"</span> <span class="k">do</span>
    <span class="n">it</span> <span class="s2">"has a request.fullpath that is defined"</span> <span class="k">do</span>
      <span class="n">expect</span><span class="p">(</span><span class="n">controller</span><span class="p">.</span><span class="nf">request</span><span class="p">.</span><span class="nf">fullpath</span><span class="p">).</span><span class="nf">to</span> <span class="n">eq</span> <span class="n">widgets_path</span>
    <span class="k">end</span>
  <span class="k">end</span>
</code></pre></div>
<p><em>When</em> I run <code>rspec spec/views</code></p>

<p><em>Then</em> the examples should all pass.</p>

<h2>View spec actions that require extra parameters have <code>request.fullpath</code> set when the developer supplies them</h2>

<p><em>Given</em> a file named &ldquo;spec/views/widgets/show.html.erb_spec.rb&rdquo; with:</p>
<div class="highlight"><pre class="highlight ruby"><code>  <span class="nb">require</span> <span class="s2">"rails_helper"</span>

  <span class="no">RSpec</span><span class="p">.</span><span class="nf">describe</span> <span class="s2">"widgets/show"</span> <span class="k">do</span>
    <span class="n">it</span> <span class="s2">"displays the widget with id: 1"</span> <span class="k">do</span>
      <span class="n">widget</span> <span class="o">=</span> <span class="no">Widget</span><span class="p">.</span><span class="nf">create!</span><span class="p">(</span><span class="ss">:name</span> <span class="o">=&gt;</span> <span class="s2">"slicer"</span><span class="p">)</span>
      <span class="n">controller</span><span class="p">.</span><span class="nf">extra_params</span> <span class="o">=</span> <span class="p">{</span> <span class="ss">:id</span> <span class="o">=&gt;</span> <span class="n">widget</span><span class="p">.</span><span class="nf">id</span> <span class="p">}</span>

      <span class="n">expect</span><span class="p">(</span><span class="n">controller</span><span class="p">.</span><span class="nf">request</span><span class="p">.</span><span class="nf">fullpath</span><span class="p">).</span><span class="nf">to</span> <span class="n">eq</span> <span class="n">widget_path</span><span class="p">(</span><span class="n">widget</span><span class="p">)</span>
    <span class="k">end</span>
  <span class="k">end</span>
</code></pre></div>
<p><em>When</em> I run <code>rspec spec/views</code></p>

<p><em>Then</em> the examples should all pass.</p>
</article></section><footer><div>Created with the assistance of Ninefold<img src="/images/brutus-half.png" alt="Brutus" /></div><br /><a href="https://dnsimple.link/resolving-rspec" target="_blank">Resolving with<br /><img src="https://cdn.dnsimple.com/assets/resolving-with-us/logo-dark.png" alt="DNSimple" style="width:100px;" /></a></footer></body><script src="/javascripts/asciinema-player.js"></script></html>