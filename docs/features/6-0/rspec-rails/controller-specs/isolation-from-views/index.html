<!DOCTYPE html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"><![endif]-->
<!--[if IE 7]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if IE 8]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]<!--><html class="no-js" lang="en"><!--<![endif]--><head><meta charset="UTF-8" /><meta content="width=device-width, initial-scale=1" name="viewport" /><meta property="og:title" /><meta content="https://rspec.info/features/6-0/rspec-rails/controller-specs/isolation-from-views/" property="og:url" /><meta content="https://rspec.info/images/logo_ogp.png" property="og:image" /><meta content="summary" name="twitter:card" /><meta content="@rspec" name="twitter:site" /><title></title><link href="/stylesheets/pages/features.css" rel="stylesheet" /><link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet" type="text/css" /><link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro" rel="stylesheet" type="text/css" /><link href="https://fonts.googleapis.com/css?family=Inconsolata" rel="stylesheet" type="text/css" /><link href="/blog/feed.xml" rel="alternate" type="application/atom+xml" /></head><body class="features"><header><nav><h1><img src="/images/logo.png" alt="Logo" /><a href="/">RSpec</a></h1><input class="hamburger-toggle" type="checkbox" /><div class="hamburger-icon"><div class="bar"></div><div class="bar"></div><div class="bar"></div></div><ul class="menu"><li><a href="/about">About</a></li><li><a href="/documentation">Documentation</a></li><li><a href="/blog">Blog</a></li><li><a href="/upgrading-from-rspec-2">Upgrade</a></li><li><a href="/help">Get Help</a></li><li><a href="/contributing">Contributing</a></li></ul></nav></header><nav class="top-nav-bar" role="navigation"><ul><li>Library:</li><li><a class="title">RSpec Rails</a><ul aria-haspopup="true" aria-label="submenu"><li><a href="/features/3-12/rspec-core">RSpec Core</a></li><li><a href="/features/3-12/rspec-expectations">RSpec Expectations</a></li><li><a href="/features/3-12/rspec-mocks">RSpec Mocks</a></li><li class="current"><a href="/features/6-0/rspec-rails">RSpec Rails</a></li></ul></li><li>Version:</li><li><a class="title">6.0</a><ul aria-haspopup="true" aria-label="submenu"><li class="current"><a href="/features/6-0/rspec-rails">6.0</a></li></ul></li></ul></nav><section><nav><ul><li><a href="/features/6-0/rspec-rails/Transactions">Transactions</a></li><li><a href="/features/6-0/rspec-rails/directory-structure">Directory structure</a></li><li><a href="/features/6-0/rspec-rails/backtrace-filtering">Backtrace filtering</a></li><li><a href="/features/6-0/rspec-rails/model-specs">Model specs</a><ul><li><a href="/features/6-0/rspec-rails/model-specs/transactional-examples"> Transactional examples</a></li><li><a href="/features/6-0/rspec-rails/model-specs/verified-doubles"> Using verified doubles</a></li></ul></li><li><a href="/features/6-0/rspec-rails/controller-specs">Controller specs</a><ul class="open"><li><a href="/features/6-0/rspec-rails/controller-specs/cookies"> Cookies</a></li><li><a href="/features/6-0/rspec-rails/controller-specs/controller-spec"> Controller specs</a></li><li><a href="/features/6-0/rspec-rails/controller-specs/isolation-from-views"> Views are stubbed by default</a></li><li><a href="/features/6-0/rspec-rails/controller-specs/render-views"> Using `render_views`</a></li><li><a href="/features/6-0/rspec-rails/controller-specs/anonymous-controller"> Using an anonymous controller</a></li><li><a href="/features/6-0/rspec-rails/controller-specs/bypass-rescue"> Using `bypass_rescue`</a></li><li><a href="/features/6-0/rspec-rails/controller-specs/engine-routes"> Engine routes for controllers</a></li><li><a href="/features/6-0/rspec-rails/controller-specs/setting-request-headers"> Setting request headers</a></li></ul></li><li><a href="/features/6-0/rspec-rails/matchers">Matchers</a><ul><li><a href="/features/6-0/rspec-rails/matchers/new-record-matcher"> `be_a_new` matcher</a></li><li><a href="/features/6-0/rspec-rails/matchers/render-template-matcher"> `render_template` matcher</a></li><li><a href="/features/6-0/rspec-rails/matchers/redirect-to-matcher"> `redirect_to` matcher</a></li><li><a href="/features/6-0/rspec-rails/matchers/have-performed-job-matcher"> `have_performed_job` matcher</a></li><li><a href="/features/6-0/rspec-rails/matchers/have-been-performed-matcher"> `have_been_performed` matcher</a></li><li><a href="/features/6-0/rspec-rails/matchers/have-broadcasted-matcher"> `have_broadcasted_to` matcher</a></li><li><a href="/features/6-0/rspec-rails/matchers/have-enqueued-job-matcher"> `have_enqueued_job` matcher</a></li><li><a href="/features/6-0/rspec-rails/matchers/have-stream-from-matcher"> `have_stream_from` matcher</a></li><li><a href="/features/6-0/rspec-rails/matchers/have-enqueued-mail-matcher"> `have_enqueued_mail` matcher</a></li><li><a href="/features/6-0/rspec-rails/matchers/have-http-status-matcher"> `have_http_status` matcher</a></li><li><a href="/features/6-0/rspec-rails/matchers/relation-match-array"> ActiveRecord::Relation match array</a></li><li><a href="/features/6-0/rspec-rails/matchers/have-been-enqueued-matcher"> `have_been_enqueued` matcher</a></li></ul></li><li><a href="/features/6-0/rspec-rails/request-specs">Request specs</a><ul><li><a href="/features/6-0/rspec-rails/request-specs/request-spec"> Request specs</a></li></ul></li><li><a href="/features/6-0/rspec-rails/feature-specs">Feature specs</a><ul><li><a href="/features/6-0/rspec-rails/feature-specs/feature-spec"> Feature specs</a></li></ul></li><li><a href="/features/6-0/rspec-rails/view-specs">View specs</a><ul><li><a href="/features/6-0/rspec-rails/view-specs/view-spec"> View specs</a></li><li><a href="/features/6-0/rspec-rails/view-specs/stub-template"> Using `stub_template`</a></li><li><a href="/features/6-0/rspec-rails/view-specs/inferred-controller-path"> View specs infer controller&#39;s path and action</a></li></ul></li><li><a href="/features/6-0/rspec-rails/helper-specs">Helper specs</a><ul><li><a href="/features/6-0/rspec-rails/helper-specs/helper-spec"> Helper specs</a></li></ul></li><li><a href="/features/6-0/rspec-rails/mailer-specs">Mailer specs</a><ul><li><a href="/features/6-0/rspec-rails/mailer-specs/url-helpers"> URL helpers in mailer examples</a></li><li><a href="/features/6-0/rspec-rails/mailer-specs/mailer-spec"> Mailer specs</a></li></ul></li><li><a href="/features/6-0/rspec-rails/routing-specs">Routing specs</a><ul><li><a href="/features/6-0/rspec-rails/routing-specs/route-to-matcher"> `route_to` matcher</a></li><li><a href="/features/6-0/rspec-rails/routing-specs/be-routable-matcher"> `be_routable` matcher</a></li><li><a href="/features/6-0/rspec-rails/routing-specs/named-routes"> Using named routes</a></li><li><a href="/features/6-0/rspec-rails/routing-specs/engine-routes"> Using engine routes</a></li></ul></li><li><a href="/features/6-0/rspec-rails/upgrade">Upgrade</a></li><li><a href="/features/6-0/rspec-rails/generator-specs">Generator specs</a><ul><li><a href="/features/6-0/rspec-rails/generator-specs/mailer-specs"> Mailer generator spec</a></li><li><a href="/features/6-0/rspec-rails/generator-specs/channel-specs"> Channel generator spec</a></li><li><a href="/features/6-0/rspec-rails/generator-specs/system-specs"> System generator spec</a></li><li><a href="/features/6-0/rspec-rails/generator-specs/controller-specs"> Controller generator spec</a></li><li><a href="/features/6-0/rspec-rails/generator-specs/view-specs"> View generator spec</a></li><li><a href="/features/6-0/rspec-rails/generator-specs/helper-specs"> Helper generator spec</a></li><li><a href="/features/6-0/rspec-rails/generator-specs/mailbox-specs"> Mailbox generator spec</a></li><li><a href="/features/6-0/rspec-rails/generator-specs/integration-specs"> Integration generator spec</a></li><li><a href="/features/6-0/rspec-rails/generator-specs/generator-specs"> Generator spec</a></li><li><a href="/features/6-0/rspec-rails/generator-specs/request-specs"> Request generator spec</a></li><li><a href="/features/6-0/rspec-rails/generator-specs/job-specs"> Job generator spec</a></li><li><a href="/features/6-0/rspec-rails/generator-specs/feature-specs"> Feature generator spec</a></li></ul></li><li><a href="/features/6-0/rspec-rails/GettingStarted">Gettingstarted</a></li><li><a href="/features/6-0/rspec-rails/channel-specs">Channel specs</a><ul><li><a href="/features/6-0/rspec-rails/channel-specs/channel-spec"> Channel specs</a></li></ul></li><li><a href="/features/6-0/rspec-rails/file-fixture">File fixture</a></li><li><a href="/features/6-0/rspec-rails/mailbox-specs">Mailbox specs</a><ul><li><a href="/features/6-0/rspec-rails/mailbox-specs/mailbox-spec"> Action mailbox specs</a></li></ul></li><li><a href="/features/6-0/rspec-rails/system-specs">System specs</a><ul><li><a href="/features/6-0/rspec-rails/system-specs/system-specs"> System specs</a></li></ul></li><li><a href="/features/6-0/rspec-rails/Generators">Generators</a></li><li><a href="/features/6-0/rspec-rails/job-specs">Job specs</a><ul><li><a href="/features/6-0/rspec-rails/job-specs/job-spec"> Job specs</a></li></ul></li></ul></nav><article><h1>Views are stubbed by default</h1>

<p>By default, controller specs stub views with a template that renders an empty
  string instead of the views in the app. This allows you specify which view
  template an action should try to render regardless of whether the template
  compiles cleanly.</p>

<p>NOTE: unlike rspec-rails-1.x, the real template must exist.</p>

<h2>Expect a template that is rendered by controller action (passes)</h2>

<p><em>Given</em> a file named &ldquo;spec/controllers/widgets<em>controller</em>spec.rb&rdquo; with:</p>
<div class="highlight"><pre class="highlight ruby"><code><span class="nb">require</span> <span class="s2">"rails_helper"</span>

<span class="no">RSpec</span><span class="p">.</span><span class="nf">describe</span> <span class="no">WidgetsController</span><span class="p">,</span> <span class="ss">type: :controller</span> <span class="k">do</span>
  <span class="n">describe</span> <span class="s2">"index"</span> <span class="k">do</span>
    <span class="n">it</span> <span class="s2">"renders the index template"</span> <span class="k">do</span>
      <span class="n">get</span> <span class="ss">:index</span>
      <span class="n">expect</span><span class="p">(</span><span class="n">response</span><span class="p">).</span><span class="nf">to</span> <span class="n">render_template</span><span class="p">(</span><span class="s2">"index"</span><span class="p">)</span>
      <span class="n">expect</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="nf">body</span><span class="p">).</span><span class="nf">to</span> <span class="n">eq</span> <span class="s2">""</span>
    <span class="k">end</span>
    <span class="n">it</span> <span class="s2">"renders the widgets/index template"</span> <span class="k">do</span>
      <span class="n">get</span> <span class="ss">:index</span>
      <span class="n">expect</span><span class="p">(</span><span class="n">response</span><span class="p">).</span><span class="nf">to</span> <span class="n">render_template</span><span class="p">(</span><span class="s2">"widgets/index"</span><span class="p">)</span>
      <span class="n">expect</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="nf">body</span><span class="p">).</span><span class="nf">to</span> <span class="n">eq</span> <span class="s2">""</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div>
<p><em>When</em> I run <code>rspec spec</code></p>

<p><em>Then</em> the examples should all pass.</p>

<h2>Expect a template that is not rendered by controller action (fails)</h2>

<p><em>Given</em> a file named &ldquo;spec/controllers/widgets<em>controller</em>spec.rb&rdquo; with:</p>
<div class="highlight"><pre class="highlight ruby"><code><span class="nb">require</span> <span class="s2">"rails_helper"</span>

<span class="no">RSpec</span><span class="p">.</span><span class="nf">describe</span> <span class="no">WidgetsController</span><span class="p">,</span> <span class="ss">type: :controller</span> <span class="k">do</span>
  <span class="n">describe</span> <span class="s2">"index"</span> <span class="k">do</span>
    <span class="n">it</span> <span class="s2">"renders the 'new' template"</span> <span class="k">do</span>
      <span class="n">get</span> <span class="ss">:index</span>
      <span class="n">expect</span><span class="p">(</span><span class="n">response</span><span class="p">).</span><span class="nf">to</span> <span class="n">render_template</span><span class="p">(</span><span class="s2">"new"</span><span class="p">)</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div>
<p><em>When</em> I run <code>rspec spec</code></p>

<p><em>Then</em> the output should contain &ldquo;1 example, 1 failure&rdquo;.</p>

<h2>Expect empty templates to render when view path is changed at runtime (passes)</h2>

<p><em>Given</em> a file named &ldquo;spec/controllers/things<em>controller</em>spec.rb&rdquo; with:</p>
<div class="highlight"><pre class="highlight ruby"><code><span class="nb">require</span> <span class="s2">"rails_helper"</span>

<span class="no">RSpec</span><span class="p">.</span><span class="nf">describe</span> <span class="no">ThingsController</span><span class="p">,</span> <span class="ss">type: :controller</span> <span class="k">do</span>
  <span class="n">describe</span> <span class="s2">"custom_action"</span> <span class="k">do</span>
    <span class="n">it</span> <span class="s2">"renders an empty custom_action template"</span> <span class="k">do</span>
      <span class="n">controller</span><span class="p">.</span><span class="nf">prepend_view_path</span> <span class="s1">'app/views'</span>
      <span class="n">controller</span><span class="p">.</span><span class="nf">append_view_path</span> <span class="s1">'app/views'</span>
      <span class="n">get</span> <span class="ss">:custom_action</span>
      <span class="n">expect</span><span class="p">(</span><span class="n">response</span><span class="p">).</span><span class="nf">to</span> <span class="n">render_template</span><span class="p">(</span><span class="s2">"custom_action"</span><span class="p">)</span>
      <span class="n">expect</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="nf">body</span><span class="p">).</span><span class="nf">to</span> <span class="n">eq</span> <span class="s2">""</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div>
<p><em>Given</em> a file named &ldquo;app/controllers/things_controller.rb&rdquo; with:</p>
<div class="highlight"><pre class="highlight ruby"><code><span class="k">class</span> <span class="nc">ThingsController</span> <span class="o">&lt;</span> <span class="no">ActionController</span><span class="o">::</span><span class="no">Base</span>
  <span class="n">layout</span> <span class="kp">false</span>
  <span class="k">def</span> <span class="nf">custom_action</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div>
<p><em>Given</em> a file named &ldquo;app/views/things/custom_action.html.erb&rdquo; with:</p>
<div class="highlight"><pre class="highlight plaintext"><code>
</code></pre></div>
<p><em>When</em> I run <code>rspec spec</code></p>

<p><em>Then</em> the examples should all pass.</p>

<h2>Expect a template to render the real template with render_views when view path is changed at runtime</h2>

<p><em>Given</em> a file named &ldquo;spec/controllers/things<em>controller</em>spec.rb&rdquo; with:</p>
<div class="highlight"><pre class="highlight ruby"><code><span class="nb">require</span> <span class="s2">"rails_helper"</span>

<span class="no">RSpec</span><span class="p">.</span><span class="nf">describe</span> <span class="no">ThingsController</span><span class="p">,</span> <span class="ss">type: :controller</span> <span class="k">do</span>
  <span class="n">render_views</span>

  <span class="n">it</span> <span class="s2">"renders the real custom_action template"</span> <span class="k">do</span>
    <span class="n">controller</span><span class="p">.</span><span class="nf">prepend_view_path</span> <span class="s1">'app/views'</span>
    <span class="n">get</span> <span class="ss">:custom_action</span>
    <span class="n">expect</span><span class="p">(</span><span class="n">response</span><span class="p">).</span><span class="nf">to</span> <span class="n">render_template</span><span class="p">(</span><span class="s2">"custom_action"</span><span class="p">)</span>
    <span class="n">expect</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="nf">body</span><span class="p">).</span><span class="nf">to</span> <span class="n">match</span><span class="p">(</span><span class="sr">/template for a custom action/</span><span class="p">)</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div>
<p><em>When</em> I run <code>rspec spec</code></p>

<p><em>Then</em> the examples should all pass.</p>
</article></section><footer><div>Created with the assistance of Ninefold<img src="/images/brutus-half.png" alt="Brutus" /></div><br /><a href="https://dnsimple.link/resolving-rspec" target="_blank">Resolving with<br /><img src="https://cdn.dnsimple.com/assets/resolving-with-us/logo-dark.png" alt="DNSimple" style="width:100px;" /></a></footer></body><script src="/javascripts/asciinema-player.js"></script></html>