<!DOCTYPE html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"><![endif]-->
<!--[if IE 7]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if IE 8]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]<!--><html class="no-js" lang="en"><!--<![endif]--><head><meta charset="UTF-8" /><meta content="width=device-width, initial-scale=1" name="viewport" /><meta property="og:title" /><meta content="https://rspec.info/features/3-12/rspec-expectations/built-in-matchers/include/" property="og:url" /><meta content="https://rspec.info/images/logo_ogp.png" property="og:image" /><meta content="summary" name="twitter:card" /><meta content="@rspec" name="twitter:site" /><title></title><link href="/stylesheets/pages/features.css" rel="stylesheet" /><link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet" type="text/css" /><link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro" rel="stylesheet" type="text/css" /><link href="https://fonts.googleapis.com/css?family=Inconsolata" rel="stylesheet" type="text/css" /><link href="/blog/feed.xml" rel="alternate" type="application/atom+xml" /></head><body class="features"><header><nav><h1><img src="/images/logo.png" alt="Logo" /><a href="/">RSpec</a></h1><input class="hamburger-toggle" type="checkbox" /><div class="hamburger-icon"><div class="bar"></div><div class="bar"></div><div class="bar"></div></div><ul class="menu"><li><a href="/about">About</a></li><li><a href="/documentation">Documentation</a></li><li><a href="/blog">Blog</a></li><li><a href="/upgrading-from-rspec-2">Upgrade</a></li><li><a href="/help">Get Help</a></li><li><a href="/contributing">Contributing</a></li></ul></nav></header><nav class="top-nav-bar" role="navigation"><ul><li>Library:</li><li><a class="title" href="/features/3-12/rspec-expectations">RSpec Expectations</a><ul aria-haspopup="true" aria-label="submenu"><li><a href="/features/3-12/rspec-core">RSpec Core</a></li><li class="current"><a href="/features/3-12/rspec-expectations">RSpec Expectations</a></li><li><a href="/features/3-12/rspec-mocks">RSpec Mocks</a></li><li><a href="/features/6-0/rspec-rails">RSpec Rails</a></li></ul></li><li>Version:</li><li><a class="title" href="/features/3-12/rspec-expectations">3.12</a><ul aria-haspopup="true" aria-label="submenu"><li class="current"><a href="/features/3-12/rspec-expectations">3.12</a></li></ul></li></ul></nav><section><nav><ul><li><a href="/features/3-12/rspec-expectations/built-in-matchers">Built in matchers</a><ul class="open"><li><a href="/features/3-12/rspec-expectations/built-in-matchers/equality"> Equality matchers</a></li><li><a href="/features/3-12/rspec-expectations/built-in-matchers/comparisons"> Comparison matchers</a></li><li><a href="/features/3-12/rspec-expectations/built-in-matchers/predicates"> Predicate matchers</a></li><li><a href="/features/3-12/rspec-expectations/built-in-matchers/types"> Type matchers</a></li><li><a href="/features/3-12/rspec-expectations/built-in-matchers/all"> `all` matcher</a></li><li><a href="/features/3-12/rspec-expectations/built-in-matchers/be"> `be` matchers</a></li><li><a href="/features/3-12/rspec-expectations/built-in-matchers/be-within"> `be_within` matcher</a></li><li><a href="/features/3-12/rspec-expectations/built-in-matchers/exist"> `exist` matcher</a></li><li><a href="/features/3-12/rspec-expectations/built-in-matchers/change"> `change` matcher</a></li><li><a href="/features/3-12/rspec-expectations/built-in-matchers/contain-exactly"> `contain_exactly` matcher</a></li><li><a href="/features/3-12/rspec-expectations/built-in-matchers/cover"> `cover` matcher</a></li><li><a href="/features/3-12/rspec-expectations/built-in-matchers/end-with"> `end_with` matcher</a></li><li><a href="/features/3-12/rspec-expectations/built-in-matchers/exist"> `exist` matcher</a></li><li><a href="/features/3-12/rspec-expectations/built-in-matchers/have-attributes"> `have_attributes` matcher</a></li><li><a href="/features/3-12/rspec-expectations/built-in-matchers/include"> `include` matcher</a></li><li><a href="/features/3-12/rspec-expectations/built-in-matchers/match"> `match` matcher</a></li><li><a href="/features/3-12/rspec-expectations/built-in-matchers/raise-error"> `raise_error` matcher</a></li><li><a href="/features/3-12/rspec-expectations/built-in-matchers/respond-to"> `respond_to` matcher</a></li><li><a href="/features/3-12/rspec-expectations/built-in-matchers/satisfy"> `satisfy` matcher</a></li><li><a href="/features/3-12/rspec-expectations/built-in-matchers/start-with"> `start_with` matcher</a></li><li><a href="/features/3-12/rspec-expectations/built-in-matchers/throw-symbol"> `throw_symbol` matcher</a></li><li><a href="/features/3-12/rspec-expectations/built-in-matchers/yield"> `yield` matchers</a></li><li><a href="/features/3-12/rspec-expectations/built-in-matchers/output"> `output` matcher</a></li></ul></li><li><a href="/features/3-12/rspec-expectations/custom-matchers">Custom matchers</a><ul><li><a href="/features/3-12/rspec-expectations/custom-matchers/define-matcher"> Defining a custom matcher</a></li><li><a href="/features/3-12/rspec-expectations/custom-matchers/define-diffable-matcher"> Defining a diffable matcher</a></li><li><a href="/features/3-12/rspec-expectations/custom-matchers/define-matcher-with-fluent-interface"> Defining a matcher with fluent interface</a></li><li><a href="/features/3-12/rspec-expectations/custom-matchers/access-running-example"> Access the running example</a></li><li><a href="/features/3-12/rspec-expectations/custom-matchers/define-matcher-outside-rspec"> Defining a matcher outside rspec</a></li><li><a href="/features/3-12/rspec-expectations/custom-matchers/define-block-matcher"> Defining a matcher supporting block expectations</a></li></ul></li><li><a href="/features/3-12/rspec-expectations/aggregating-failures">Aggregating failures</a></li><li><a href="/features/3-12/rspec-expectations/composing-matchers">Composing matchers</a></li><li><a href="/features/3-12/rspec-expectations/compound-expectations">Compound expectations</a></li><li><a href="/features/3-12/rspec-expectations/define-negated-matcher">Define negated matcher</a></li><li><a href="/features/3-12/rspec-expectations/customized-message">Customized message</a></li><li><a href="/features/3-12/rspec-expectations/diffing">Diffing</a></li><li><a href="/features/3-12/rspec-expectations/implicit-docstrings">Implicit docstrings</a></li><li><a href="/features/3-12/rspec-expectations/syntax-configuration">Syntax configuration</a></li><li><a href="/features/3-12/rspec-expectations/test-frameworks">Test frameworks</a><ul><li><a href="/features/3-12/rspec-expectations/test-frameworks/minitest"> Minitest integration</a></li></ul></li></ul></nav><article><h1><code>include</code> matcher</h1>

<p>Use the <code>include</code> matcher to specify that a collection includes one or more expected objects. It succeeds if any object of the given collection passes the specified matcher. This works on any object that responds to <code>#include?</code> (such as a string or array):</p>
<div class="highlight"><pre class="highlight plaintext"><code>```ruby
expect("a string").to include("a")
expect("a string").to include(/a|str/).twice
expect("a string").to include("str", "g")
expect("a string").not_to include("foo")

expect([1, 2]).to include(1)
expect([1, 2]).to include(1, 2)
expect([1, 2]).to include(a_kind_of(Integer))
expect([1, 2]).to include(be_odd.and be &lt; 10 )
expect([1, 2]).to include(be_odd)
expect([1, 2]).to include(be &lt; 10).at_least(2).times
expect([1, 2]).not_to include(17)
```
</code></pre></div>
<p>The matcher also provides flexible handling for hashes:</p>
<div class="highlight"><pre class="highlight plaintext"><code>```ruby
expect(:a =&gt; 1, :b =&gt; 2).to include(:a)
expect(:a =&gt; 1, :b =&gt; 2).to include(:a, :b)
expect(:a =&gt; 1, :b =&gt; 2).to include(:a =&gt; 1)
expect(:a =&gt; 1, :b =&gt; 2).to include(:b =&gt; 2, :a =&gt; 1)
expect(:a =&gt; 1, :b =&gt; 2).to include(match(/b/) =&gt; 2)
expect(:a =&gt; 1, :b =&gt; 2).to include(match(/b/) =&gt; be_even)
expect(:a =&gt; 1, :b =&gt; 2).not_to include(:c)
expect(:a =&gt; 1, :b =&gt; 2).not_to include(:a =&gt; 2)
expect(:a =&gt; 1, :b =&gt; 2).not_to include(:c =&gt; 3)
```
</code></pre></div>
<h2>Array usage</h2>

<p><em>Given</em> a file named &ldquo;array<em>include</em>matcher_spec.rb&rdquo; with:</p>
<div class="highlight"><pre class="highlight ruby"><code><span class="no">RSpec</span><span class="p">.</span><span class="nf">describe</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">]</span> <span class="k">do</span>
  <span class="n">it</span> <span class="p">{</span> <span class="n">is_expected</span><span class="p">.</span><span class="nf">to</span> <span class="kp">include</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">}</span>
  <span class="n">it</span> <span class="p">{</span> <span class="n">is_expected</span><span class="p">.</span><span class="nf">to</span> <span class="kp">include</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="p">}</span>
  <span class="n">it</span> <span class="p">{</span> <span class="n">is_expected</span><span class="p">.</span><span class="nf">to</span> <span class="kp">include</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="p">}</span>
  <span class="n">it</span> <span class="p">{</span> <span class="n">is_expected</span><span class="p">.</span><span class="nf">to</span> <span class="kp">include</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span> <span class="p">}</span>
  <span class="n">it</span> <span class="p">{</span> <span class="n">is_expected</span><span class="p">.</span><span class="nf">to</span> <span class="kp">include</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span> <span class="p">}</span>
  <span class="n">it</span> <span class="p">{</span> <span class="n">is_expected</span><span class="p">.</span><span class="nf">to</span> <span class="kp">include</span><span class="p">(</span><span class="n">a_kind_of</span><span class="p">(</span><span class="no">Integer</span><span class="p">))</span> <span class="p">}</span>
  <span class="n">it</span> <span class="p">{</span> <span class="n">is_expected</span><span class="p">.</span><span class="nf">to</span> <span class="kp">include</span><span class="p">(</span><span class="n">be_odd</span><span class="p">.</span><span class="nf">and</span> <span class="n">be</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">)</span> <span class="p">}</span>
  <span class="n">it</span> <span class="p">{</span> <span class="n">is_expected</span><span class="p">.</span><span class="nf">to</span> <span class="kp">include</span><span class="p">(</span><span class="n">be_odd</span><span class="p">).</span><span class="nf">at_least</span><span class="p">(</span><span class="ss">:twice</span><span class="p">)</span> <span class="p">}</span>
  <span class="n">it</span> <span class="p">{</span> <span class="n">is_expected</span><span class="p">.</span><span class="nf">not_to</span> <span class="kp">include</span><span class="p">(</span><span class="n">be_even</span><span class="p">)</span> <span class="p">}</span>
  <span class="n">it</span> <span class="p">{</span> <span class="n">is_expected</span><span class="p">.</span><span class="nf">not_to</span> <span class="kp">include</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span> <span class="p">}</span>
  <span class="n">it</span> <span class="p">{</span> <span class="n">is_expected</span><span class="p">.</span><span class="nf">not_to</span> <span class="kp">include</span><span class="p">(</span><span class="mi">43</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span> <span class="p">}</span>

  <span class="c1"># deliberate failures</span>
  <span class="n">it</span> <span class="p">{</span> <span class="n">is_expected</span><span class="p">.</span><span class="nf">to</span> <span class="kp">include</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="p">}</span>
  <span class="n">it</span> <span class="p">{</span> <span class="n">is_expected</span><span class="p">.</span><span class="nf">to</span> <span class="kp">include</span><span class="p">(</span><span class="n">be_even</span><span class="p">)</span> <span class="p">}</span>
  <span class="n">it</span> <span class="p">{</span> <span class="n">is_expected</span><span class="p">.</span><span class="nf">to</span> <span class="kp">include</span><span class="p">(</span><span class="n">be_odd</span><span class="p">).</span><span class="nf">at_most</span><span class="p">(</span><span class="mi">2</span><span class="p">).</span><span class="nf">times</span> <span class="p">}</span>
  <span class="n">it</span> <span class="p">{</span> <span class="n">is_expected</span><span class="p">.</span><span class="nf">not_to</span> <span class="kp">include</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">}</span>
  <span class="n">it</span> <span class="p">{</span> <span class="n">is_expected</span><span class="p">.</span><span class="nf">not_to</span> <span class="kp">include</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="p">}</span>
  <span class="n">it</span> <span class="p">{</span> <span class="n">is_expected</span><span class="p">.</span><span class="nf">not_to</span> <span class="kp">include</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="p">}</span>
  <span class="n">it</span> <span class="p">{</span> <span class="n">is_expected</span><span class="p">.</span><span class="nf">not_to</span> <span class="kp">include</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span> <span class="p">}</span>

  <span class="c1"># both of these should fail since it includes 1 but not 9</span>
  <span class="n">it</span> <span class="p">{</span> <span class="n">is_expected</span><span class="p">.</span><span class="nf">to</span> <span class="kp">include</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span> <span class="p">}</span>
  <span class="n">it</span> <span class="p">{</span> <span class="n">is_expected</span><span class="p">.</span><span class="nf">not_to</span> <span class="kp">include</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span> <span class="p">}</span>
<span class="k">end</span>
</code></pre></div>
<p><em>When</em> I run <code>rspec array_include_matcher_spec.rb</code></p>

<p><em>Then</em> the output should contain all of these:</p>

<table><thead>
<tr>
<th></th>
</tr>
</thead><tbody>
<tr>
<td>20 examples, 9 failures</td>
</tr>
<tr>
<td>expected [1, 3, 7] to include 4</td>
</tr>
<tr>
<td>expected [1, 3, 7] to include (be even)</td>
</tr>
<tr>
<td>expected [1, 3, 7] to include (be odd) at most twice but it is included 3 times</td>
</tr>
<tr>
<td>expected [1, 3, 7] not to include 1</td>
</tr>
<tr>
<td>expected [1, 3, 7] not to include 3</td>
</tr>
<tr>
<td>expected [1, 3, 7] not to include 7</td>
</tr>
<tr>
<td>expected [1, 3, 7] not to include 1, 3, and 7</td>
</tr>
<tr>
<td>expected [1, 3, 7] to include 9</td>
</tr>
<tr>
<td>expected [1, 3, 7] not to include 1</td>
</tr>
</tbody></table>

<h2>String usage</h2>

<p><em>Given</em> a file named &ldquo;string<em>include</em>matcher_spec.rb&rdquo; with:</p>
<div class="highlight"><pre class="highlight ruby"><code><span class="no">RSpec</span><span class="p">.</span><span class="nf">describe</span> <span class="s2">"a string"</span> <span class="k">do</span>
  <span class="n">it</span> <span class="p">{</span> <span class="n">is_expected</span><span class="p">.</span><span class="nf">to</span> <span class="kp">include</span><span class="p">(</span><span class="s2">"str"</span><span class="p">)</span> <span class="p">}</span>
  <span class="n">it</span> <span class="p">{</span> <span class="n">is_expected</span><span class="p">.</span><span class="nf">to</span> <span class="kp">include</span><span class="p">(</span><span class="s2">"a"</span><span class="p">,</span> <span class="s2">"str"</span><span class="p">,</span> <span class="s2">"ng"</span><span class="p">)</span> <span class="p">}</span>
  <span class="n">it</span> <span class="p">{</span> <span class="n">is_expected</span><span class="p">.</span><span class="nf">to</span> <span class="kp">include</span><span class="p">(</span><span class="sr">/a|str/</span><span class="p">).</span><span class="nf">twice</span> <span class="p">}</span>
  <span class="n">it</span> <span class="p">{</span> <span class="n">is_expected</span><span class="p">.</span><span class="nf">not_to</span> <span class="kp">include</span><span class="p">(</span><span class="s2">"foo"</span><span class="p">)</span> <span class="p">}</span>
  <span class="n">it</span> <span class="p">{</span> <span class="n">is_expected</span><span class="p">.</span><span class="nf">not_to</span> <span class="kp">include</span><span class="p">(</span><span class="s2">"foo"</span><span class="p">,</span> <span class="s2">"bar"</span><span class="p">)</span> <span class="p">}</span>

  <span class="c1"># deliberate failures</span>
  <span class="n">it</span> <span class="p">{</span> <span class="n">is_expected</span><span class="p">.</span><span class="nf">to</span> <span class="kp">include</span><span class="p">(</span><span class="s2">"foo"</span><span class="p">)</span> <span class="p">}</span>
  <span class="n">it</span> <span class="p">{</span> <span class="n">is_expected</span><span class="p">.</span><span class="nf">not_to</span> <span class="kp">include</span><span class="p">(</span><span class="s2">"str"</span><span class="p">)</span> <span class="p">}</span>
  <span class="n">it</span> <span class="p">{</span> <span class="n">is_expected</span><span class="p">.</span><span class="nf">to</span> <span class="kp">include</span><span class="p">(</span><span class="s2">"str"</span><span class="p">).</span><span class="nf">at_least</span><span class="p">(</span><span class="ss">:twice</span><span class="p">)</span> <span class="p">}</span>
  <span class="n">it</span> <span class="p">{</span> <span class="n">is_expected</span><span class="p">.</span><span class="nf">to</span> <span class="kp">include</span><span class="p">(</span><span class="s2">"str"</span><span class="p">,</span> <span class="s2">"foo"</span><span class="p">)</span> <span class="p">}</span>
  <span class="n">it</span> <span class="p">{</span> <span class="n">is_expected</span><span class="p">.</span><span class="nf">not_to</span> <span class="kp">include</span><span class="p">(</span><span class="s2">"str"</span><span class="p">,</span> <span class="s2">"foo"</span><span class="p">)</span> <span class="p">}</span>
<span class="k">end</span>
</code></pre></div>
<p><em>When</em> I run <code>rspec string_include_matcher_spec.rb</code></p>

<p><em>Then</em> the output should contain all of these:</p>

<table><thead>
<tr>
<th></th>
</tr>
</thead><tbody>
<tr>
<td>10 examples, 5 failures</td>
</tr>
<tr>
<td>expected &ldquo;a string&rdquo; to include &ldquo;foo&rdquo;</td>
</tr>
<tr>
<td>expected &ldquo;a string&rdquo; not to include &ldquo;str&rdquo;</td>
</tr>
<tr>
<td>expected &ldquo;a string&rdquo; to include &ldquo;str&rdquo; at least twice but it is included once</td>
</tr>
<tr>
<td>expected &ldquo;a string&rdquo; to include &ldquo;foo&rdquo;</td>
</tr>
<tr>
<td>expected &ldquo;a string&rdquo; not to include &ldquo;str&rdquo;</td>
</tr>
</tbody></table>

<h2>Hash usage</h2>

<p><em>Given</em> a file named &ldquo;hash<em>include</em>matcher_spec.rb&rdquo; with:</p>
<div class="highlight"><pre class="highlight ruby"><code><span class="no">RSpec</span><span class="p">.</span><span class="nf">describe</span> <span class="ss">:a</span> <span class="o">=&gt;</span> <span class="mi">7</span><span class="p">,</span> <span class="ss">:b</span> <span class="o">=&gt;</span> <span class="mi">5</span> <span class="k">do</span>
  <span class="n">it</span> <span class="p">{</span> <span class="n">is_expected</span><span class="p">.</span><span class="nf">to</span> <span class="kp">include</span><span class="p">(</span><span class="ss">:a</span><span class="p">)</span> <span class="p">}</span>
  <span class="n">it</span> <span class="p">{</span> <span class="n">is_expected</span><span class="p">.</span><span class="nf">to</span> <span class="kp">include</span><span class="p">(</span><span class="ss">:b</span><span class="p">,</span> <span class="ss">:a</span><span class="p">)</span> <span class="p">}</span>
  <span class="n">it</span> <span class="p">{</span> <span class="n">is_expected</span><span class="p">.</span><span class="nf">to</span> <span class="kp">include</span><span class="p">(</span><span class="ss">:a</span> <span class="o">=&gt;</span> <span class="mi">7</span><span class="p">)</span> <span class="p">}</span>
  <span class="n">it</span> <span class="p">{</span> <span class="n">is_expected</span><span class="p">.</span><span class="nf">to</span> <span class="kp">include</span><span class="p">(</span><span class="ss">:b</span> <span class="o">=&gt;</span> <span class="mi">5</span><span class="p">,</span> <span class="ss">:a</span> <span class="o">=&gt;</span> <span class="mi">7</span><span class="p">)</span> <span class="p">}</span>
  <span class="n">it</span> <span class="p">{</span> <span class="n">is_expected</span><span class="p">.</span><span class="nf">not_to</span> <span class="kp">include</span><span class="p">(</span><span class="ss">:c</span><span class="p">)</span> <span class="p">}</span>
  <span class="n">it</span> <span class="p">{</span> <span class="n">is_expected</span><span class="p">.</span><span class="nf">not_to</span> <span class="kp">include</span><span class="p">(</span><span class="ss">:c</span><span class="p">,</span> <span class="ss">:d</span><span class="p">)</span> <span class="p">}</span>
  <span class="n">it</span> <span class="p">{</span> <span class="n">is_expected</span><span class="p">.</span><span class="nf">not_to</span> <span class="kp">include</span><span class="p">(</span><span class="ss">:d</span> <span class="o">=&gt;</span> <span class="mi">2</span><span class="p">)</span> <span class="p">}</span>
  <span class="n">it</span> <span class="p">{</span> <span class="n">is_expected</span><span class="p">.</span><span class="nf">not_to</span> <span class="kp">include</span><span class="p">(</span><span class="ss">:a</span> <span class="o">=&gt;</span> <span class="mi">5</span><span class="p">)</span> <span class="p">}</span>
  <span class="n">it</span> <span class="p">{</span> <span class="n">is_expected</span><span class="p">.</span><span class="nf">not_to</span> <span class="kp">include</span><span class="p">(</span><span class="ss">:b</span> <span class="o">=&gt;</span> <span class="mi">7</span><span class="p">,</span> <span class="ss">:a</span> <span class="o">=&gt;</span> <span class="mi">5</span><span class="p">)</span> <span class="p">}</span>

  <span class="c1"># deliberate failures</span>
  <span class="n">it</span> <span class="p">{</span> <span class="n">is_expected</span><span class="p">.</span><span class="nf">not_to</span> <span class="kp">include</span><span class="p">(</span><span class="ss">:a</span><span class="p">)</span> <span class="p">}</span>
  <span class="n">it</span> <span class="p">{</span> <span class="n">is_expected</span><span class="p">.</span><span class="nf">not_to</span> <span class="kp">include</span><span class="p">(</span><span class="ss">:b</span><span class="p">,</span> <span class="ss">:a</span><span class="p">)</span> <span class="p">}</span>
  <span class="n">it</span> <span class="p">{</span> <span class="n">is_expected</span><span class="p">.</span><span class="nf">not_to</span> <span class="kp">include</span><span class="p">(</span><span class="ss">:a</span> <span class="o">=&gt;</span> <span class="mi">7</span><span class="p">)</span> <span class="p">}</span>
  <span class="n">it</span> <span class="p">{</span> <span class="n">is_expected</span><span class="p">.</span><span class="nf">not_to</span> <span class="kp">include</span><span class="p">(</span><span class="ss">:a</span> <span class="o">=&gt;</span> <span class="mi">7</span><span class="p">,</span> <span class="ss">:b</span> <span class="o">=&gt;</span> <span class="mi">5</span><span class="p">)</span> <span class="p">}</span>
  <span class="n">it</span> <span class="p">{</span> <span class="n">is_expected</span><span class="p">.</span><span class="nf">to</span> <span class="kp">include</span><span class="p">(</span><span class="ss">:c</span><span class="p">)</span> <span class="p">}</span>
  <span class="n">it</span> <span class="p">{</span> <span class="n">is_expected</span><span class="p">.</span><span class="nf">to</span> <span class="kp">include</span><span class="p">(</span><span class="ss">:c</span><span class="p">,</span> <span class="ss">:d</span><span class="p">)</span> <span class="p">}</span>
  <span class="n">it</span> <span class="p">{</span> <span class="n">is_expected</span><span class="p">.</span><span class="nf">to</span> <span class="kp">include</span><span class="p">(</span><span class="ss">:d</span> <span class="o">=&gt;</span> <span class="mi">2</span><span class="p">)</span> <span class="p">}</span>
  <span class="n">it</span> <span class="p">{</span> <span class="n">is_expected</span><span class="p">.</span><span class="nf">to</span> <span class="kp">include</span><span class="p">(</span><span class="ss">:a</span> <span class="o">=&gt;</span> <span class="mi">5</span><span class="p">)</span> <span class="p">}</span>
  <span class="n">it</span> <span class="p">{</span> <span class="n">is_expected</span><span class="p">.</span><span class="nf">to</span> <span class="kp">include</span><span class="p">(</span><span class="ss">:a</span> <span class="o">=&gt;</span> <span class="mi">5</span><span class="p">,</span> <span class="ss">:b</span> <span class="o">=&gt;</span> <span class="mi">7</span><span class="p">)</span> <span class="p">}</span>

  <span class="c1"># Mixed cases--the hash includes one but not the other.</span>
  <span class="c1"># All 4 of these cases should fail.</span>
  <span class="n">it</span> <span class="p">{</span> <span class="n">is_expected</span><span class="p">.</span><span class="nf">to</span> <span class="kp">include</span><span class="p">(</span><span class="ss">:a</span><span class="p">,</span> <span class="ss">:d</span><span class="p">)</span> <span class="p">}</span>
  <span class="n">it</span> <span class="p">{</span> <span class="n">is_expected</span><span class="p">.</span><span class="nf">not_to</span> <span class="kp">include</span><span class="p">(</span><span class="ss">:a</span><span class="p">,</span> <span class="ss">:d</span><span class="p">)</span> <span class="p">}</span>
  <span class="n">it</span> <span class="p">{</span> <span class="n">is_expected</span><span class="p">.</span><span class="nf">to</span> <span class="kp">include</span><span class="p">(</span><span class="ss">:a</span> <span class="o">=&gt;</span> <span class="mi">7</span><span class="p">,</span> <span class="ss">:d</span> <span class="o">=&gt;</span> <span class="mi">3</span><span class="p">)</span> <span class="p">}</span>
  <span class="n">it</span> <span class="p">{</span> <span class="n">is_expected</span><span class="p">.</span><span class="nf">not_to</span> <span class="kp">include</span><span class="p">(</span><span class="ss">:a</span> <span class="o">=&gt;</span> <span class="mi">7</span><span class="p">,</span> <span class="ss">:d</span> <span class="o">=&gt;</span> <span class="mi">3</span><span class="p">)</span> <span class="p">}</span>
<span class="k">end</span>
</code></pre></div>
<p><em>When</em> I run <code>rspec hash_include_matcher_spec.rb</code></p>

<p><em>Then</em> the output should contain all of these:</p>

<table><thead>
<tr>
<th></th>
</tr>
</thead><tbody>
<tr>
<td>22 examples, 13 failures</td>
</tr>
<tr>
<td>expected {:a =&gt; 7, :b =&gt; 5} not to include :a</td>
</tr>
<tr>
<td>expected {:a =&gt; 7, :b =&gt; 5} not to include :b and :a</td>
</tr>
<tr>
<td>expected {:a =&gt; 7, :b =&gt; 5} not to include {:a =&gt; 7}</td>
</tr>
<tr>
<td>expected {:a =&gt; 7, :b =&gt; 5} not to include {:a =&gt; 7, :b =&gt; 5}</td>
</tr>
<tr>
<td>expected {:a =&gt; 7, :b =&gt; 5} to include :c</td>
</tr>
<tr>
<td>expected {:a =&gt; 7, :b =&gt; 5} to include :c and :d</td>
</tr>
<tr>
<td>expected {:a =&gt; 7, :b =&gt; 5} to include {:d =&gt; 2}</td>
</tr>
<tr>
<td>expected {:a =&gt; 7, :b =&gt; 5} to include {:a =&gt; 5}</td>
</tr>
<tr>
<td>expected {:a =&gt; 7, :b =&gt; 5} to include {:a =&gt; 5, :b =&gt; 7}</td>
</tr>
<tr>
<td>expected {:a =&gt; 7, :b =&gt; 5} to include :d</td>
</tr>
<tr>
<td>expected {:a =&gt; 7, :b =&gt; 5} not to include :a</td>
</tr>
<tr>
<td>expected {:a =&gt; 7, :b =&gt; 5} to include {:d =&gt; 3}</td>
</tr>
<tr>
<td>expected {:a =&gt; 7, :b =&gt; 5} not to include {:a =&gt; 7}</td>
</tr>
</tbody></table>

<h2>Counts usage</h2>

<p><em>Given</em> a file named &ldquo;include<em>matcher</em>with<em>counts</em>spec.rb&rdquo; with:</p>
<div class="highlight"><pre class="highlight ruby"><code>  <span class="no">RSpec</span><span class="p">.</span><span class="nf">describe</span> <span class="p">[{</span><span class="ss">:c</span> <span class="o">=&gt;</span> <span class="mi">7</span><span class="p">},</span> <span class="p">{</span><span class="ss">:a</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">},</span> <span class="p">{</span><span class="ss">:b</span> <span class="o">=&gt;</span> <span class="mi">2</span><span class="p">},</span> <span class="p">{</span><span class="ss">:c</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">},</span> <span class="p">{</span><span class="ss">:a</span> <span class="o">=&gt;</span> <span class="mi">3</span><span class="p">},</span> <span class="p">{</span><span class="ss">:c</span> <span class="o">=&gt;</span> <span class="mi">7</span><span class="p">}]</span> <span class="k">do</span>
    <span class="n">it</span> <span class="p">{</span> <span class="n">is_expected</span><span class="p">.</span><span class="nf">to</span> <span class="kp">include</span><span class="p">(</span><span class="ss">:b</span> <span class="o">=&gt;</span> <span class="mi">2</span><span class="p">).</span><span class="nf">exactly</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="nf">times</span> <span class="p">}</span>
    <span class="n">it</span> <span class="p">{</span> <span class="n">is_expected</span><span class="p">.</span><span class="nf">to</span> <span class="kp">include</span><span class="p">(</span><span class="ss">:b</span> <span class="o">=&gt;</span> <span class="mi">2</span><span class="p">).</span><span class="nf">once</span> <span class="p">}</span>
    <span class="n">it</span> <span class="p">{</span> <span class="n">is_expected</span><span class="p">.</span><span class="nf">to</span> <span class="kp">include</span><span class="p">(</span><span class="n">have_key</span><span class="p">(</span><span class="ss">:a</span><span class="p">)).</span><span class="nf">twice</span> <span class="p">}</span>
    <span class="n">it</span> <span class="p">{</span> <span class="n">is_expected</span><span class="p">.</span><span class="nf">to</span> <span class="kp">include</span><span class="p">(</span><span class="n">have_key</span><span class="p">(</span><span class="ss">:c</span><span class="p">)).</span><span class="nf">at_least</span><span class="p">(</span><span class="mi">2</span><span class="p">).</span><span class="nf">times</span> <span class="p">}</span>
    <span class="n">it</span> <span class="p">{</span> <span class="n">is_expected</span><span class="p">.</span><span class="nf">to</span> <span class="kp">include</span><span class="p">(</span><span class="n">have_key</span><span class="p">(</span><span class="ss">:a</span><span class="p">)).</span><span class="nf">at_least</span><span class="p">(</span><span class="ss">:once</span><span class="p">)</span> <span class="p">}</span>
    <span class="n">it</span> <span class="p">{</span> <span class="n">is_expected</span><span class="p">.</span><span class="nf">to</span> <span class="kp">include</span><span class="p">(</span><span class="n">have_key</span><span class="p">(</span><span class="ss">:c</span><span class="p">)).</span><span class="nf">at_least</span><span class="p">(</span><span class="ss">:twice</span><span class="p">)</span> <span class="p">}</span>
    <span class="n">it</span> <span class="p">{</span> <span class="n">is_expected</span><span class="p">.</span><span class="nf">to</span> <span class="kp">include</span><span class="p">(</span><span class="n">have_key</span><span class="p">(</span><span class="ss">:d</span><span class="p">)).</span><span class="nf">at_most</span><span class="p">(</span><span class="ss">:once</span><span class="p">)</span> <span class="p">}</span>
    <span class="n">it</span> <span class="p">{</span> <span class="n">is_expected</span><span class="p">.</span><span class="nf">to</span> <span class="kp">include</span><span class="p">(</span><span class="n">have_key</span><span class="p">(</span><span class="ss">:b</span><span class="p">)).</span><span class="nf">at_most</span><span class="p">(</span><span class="ss">:twice</span><span class="p">)</span> <span class="p">}</span>

    <span class="c1"># deliberate failures</span>
    <span class="n">it</span> <span class="p">{</span> <span class="n">is_expected</span><span class="p">.</span><span class="nf">not_to</span> <span class="kp">include</span><span class="p">(</span><span class="n">have_key</span><span class="p">(</span><span class="ss">:b</span><span class="p">)).</span><span class="nf">once</span> <span class="p">}</span>
    <span class="n">it</span> <span class="p">{</span> <span class="n">is_expected</span><span class="p">.</span><span class="nf">not_to</span> <span class="kp">include</span><span class="p">(</span><span class="n">have_key</span><span class="p">(</span><span class="ss">:a</span><span class="p">)).</span><span class="nf">twice</span> <span class="p">}</span>
    <span class="n">it</span> <span class="p">{</span> <span class="n">is_expected</span><span class="p">.</span><span class="nf">not_to</span> <span class="kp">include</span><span class="p">(</span><span class="n">have_key</span><span class="p">(</span><span class="ss">:c</span><span class="p">)).</span><span class="nf">at_least</span><span class="p">(</span><span class="mi">2</span><span class="p">).</span><span class="nf">times</span> <span class="p">}</span>
    <span class="n">it</span> <span class="p">{</span> <span class="n">is_expected</span><span class="p">.</span><span class="nf">not_to</span> <span class="kp">include</span><span class="p">(</span><span class="n">have_key</span><span class="p">(</span><span class="ss">:d</span><span class="p">)).</span><span class="nf">at_most</span><span class="p">(</span><span class="ss">:once</span><span class="p">)</span> <span class="p">}</span>
  <span class="k">end</span>
</code></pre></div>
<p><em>When</em> I run <code>rspec include_matcher_with_counts_spec.rb</code></p>

<p><em>Then</em> the output should contain all of these:</p>

<table><thead>
<tr>
<th></th>
</tr>
</thead><tbody>
<tr>
<td>12 examples, 4 failures</td>
</tr>
<tr>
<td>expected [{:c =&gt; 7}, {:a =&gt; 1}, {:b =&gt; 2}, {:c =&gt; 1}, {:a =&gt; 3}, {:c =&gt; 7}] not to include (have key :b) once</td>
</tr>
<tr>
<td>expected [{:c =&gt; 7}, {:a =&gt; 1}, {:b =&gt; 2}, {:c =&gt; 1}, {:a =&gt; 3}, {:c =&gt; 7}] not to include (have key :a) twice</td>
</tr>
<tr>
<td>expected [{:c =&gt; 7}, {:a =&gt; 1}, {:b =&gt; 2}, {:c =&gt; 1}, {:a =&gt; 3}, {:c =&gt; 7}] not to include (have key :c) at least twice</td>
</tr>
<tr>
<td>expected [{:c =&gt; 7}, {:a =&gt; 1}, {:b =&gt; 2}, {:c =&gt; 1}, {:a =&gt; 3}, {:c =&gt; 7}] not to include (have key :d) at most once</td>
</tr>
</tbody></table>
</article></section><footer><div>Created with the assistance of Ninefold<img src="/images/brutus-half.png" alt="Brutus" /></div><br /><a href="https://dnsimple.link/resolving-rspec" target="_blank">Resolving with<br /><img src="https://cdn.dnsimple.com/assets/resolving-with-us/logo-dark.png" alt="DNSimple" style="width:100px;" /></a></footer></body><script src="/javascripts/asciinema-player.js"></script></html>