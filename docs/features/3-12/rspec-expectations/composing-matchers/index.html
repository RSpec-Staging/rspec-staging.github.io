<!DOCTYPE html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"><![endif]-->
<!--[if IE 7]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if IE 8]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]<!--><html class="no-js" lang="en"><!--<![endif]--><head><meta charset="UTF-8" /><meta content="width=device-width, initial-scale=1" name="viewport" /><meta property="og:title" /><meta content="https://rspec.info/features/3-12/rspec-expectations/composing-matchers/" property="og:url" /><meta content="https://rspec.info/images/logo_ogp.png" property="og:image" /><meta content="summary" name="twitter:card" /><meta content="@rspec" name="twitter:site" /><title></title><link href="/stylesheets/pages/features.css" rel="stylesheet" /><link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet" type="text/css" /><link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro" rel="stylesheet" type="text/css" /><link href="https://fonts.googleapis.com/css?family=Inconsolata" rel="stylesheet" type="text/css" /><link href="/blog/feed.xml" rel="alternate" type="application/atom+xml" /></head><body class="features"><header><nav><h1><img src="/images/logo.png" alt="Logo" /><a href="/">RSpec</a></h1><input class="hamburger-toggle" type="checkbox" /><div class="hamburger-icon"><div class="bar"></div><div class="bar"></div><div class="bar"></div></div><ul class="menu"><li><a href="/about">About</a></li><li><a href="/documentation">Documentation</a></li><li><a href="/blog">Blog</a></li><li><a href="/upgrading-from-rspec-2">Upgrade</a></li><li><a href="/help">Get Help</a></li><li><a href="/contributing">Contributing</a></li></ul></nav></header><nav class="top-nav-bar" role="navigation"><ul><li>Library:</li><li><a class="title" href="/features/3-12/rspec-expectations">RSpec Expectations</a><ul aria-haspopup="true" aria-label="submenu"><li><a href="/features/3-12/rspec-core">RSpec Core</a></li><li class="current"><a href="/features/3-12/rspec-expectations">RSpec Expectations</a></li><li><a href="/features/3-12/rspec-mocks">RSpec Mocks</a></li><li><a href="/features/6-0/rspec-rails">RSpec Rails</a></li></ul></li><li>Version:</li><li><a class="title" href="/features/3-12/rspec-expectations">3.12</a><ul aria-haspopup="true" aria-label="submenu"><li class="current"><a href="/features/3-12/rspec-expectations">3.12</a></li></ul></li></ul></nav><section><nav><ul><li><a href="/features/3-12/rspec-expectations/built-in-matchers/">Built in matchers</a><ul><li><a href="/features/3-12/rspec-expectations/built-in-matchers/equality/"> Equality matchers</a></li><li><a href="/features/3-12/rspec-expectations/built-in-matchers/comparisons/"> Comparison matchers</a></li><li><a href="/features/3-12/rspec-expectations/built-in-matchers/predicates/"> Predicate matchers</a></li><li><a href="/features/3-12/rspec-expectations/built-in-matchers/types/"> Type matchers</a></li><li><a href="/features/3-12/rspec-expectations/built-in-matchers/all/"> `all` matcher</a></li><li><a href="/features/3-12/rspec-expectations/built-in-matchers/be/"> `be` matchers</a></li><li><a href="/features/3-12/rspec-expectations/built-in-matchers/be-within/"> `be_within` matcher</a></li><li><a href="/features/3-12/rspec-expectations/built-in-matchers/exist/"> `exist` matcher</a></li><li><a href="/features/3-12/rspec-expectations/built-in-matchers/change/"> `change` matcher</a></li><li><a href="/features/3-12/rspec-expectations/built-in-matchers/contain-exactly/"> `contain_exactly` matcher</a></li><li><a href="/features/3-12/rspec-expectations/built-in-matchers/cover/"> `cover` matcher</a></li><li><a href="/features/3-12/rspec-expectations/built-in-matchers/end-with/"> `end_with` matcher</a></li><li><a href="/features/3-12/rspec-expectations/built-in-matchers/exist/"> `exist` matcher</a></li><li><a href="/features/3-12/rspec-expectations/built-in-matchers/have-attributes/"> `have_attributes` matcher</a></li><li><a href="/features/3-12/rspec-expectations/built-in-matchers/include/"> `include` matcher</a></li><li><a href="/features/3-12/rspec-expectations/built-in-matchers/match/"> `match` matcher</a></li><li><a href="/features/3-12/rspec-expectations/built-in-matchers/raise-error/"> `raise_error` matcher</a></li><li><a href="/features/3-12/rspec-expectations/built-in-matchers/respond-to/"> `respond_to` matcher</a></li><li><a href="/features/3-12/rspec-expectations/built-in-matchers/satisfy/"> `satisfy` matcher</a></li><li><a href="/features/3-12/rspec-expectations/built-in-matchers/start-with/"> `start_with` matcher</a></li><li><a href="/features/3-12/rspec-expectations/built-in-matchers/throw-symbol/"> `throw_symbol` matcher</a></li><li><a href="/features/3-12/rspec-expectations/built-in-matchers/yield/"> `yield` matchers</a></li><li><a href="/features/3-12/rspec-expectations/built-in-matchers/output/"> `output` matcher</a></li></ul></li><li><a href="/features/3-12/rspec-expectations/custom-matchers/">Custom matchers</a><ul><li><a href="/features/3-12/rspec-expectations/custom-matchers/define-matcher/"> Defining a custom matcher</a></li><li><a href="/features/3-12/rspec-expectations/custom-matchers/define-diffable-matcher/"> Defining a diffable matcher</a></li><li><a href="/features/3-12/rspec-expectations/custom-matchers/define-matcher-with-fluent-interface/"> Defining a matcher with fluent interface</a></li><li><a href="/features/3-12/rspec-expectations/custom-matchers/access-running-example/"> Access the running example</a></li><li><a href="/features/3-12/rspec-expectations/custom-matchers/define-matcher-outside-rspec/"> Defining a matcher outside rspec</a></li><li><a href="/features/3-12/rspec-expectations/custom-matchers/define-block-matcher/"> Defining a matcher supporting block expectations</a></li></ul></li><li><a href="/features/3-12/rspec-expectations/aggregating-failures/">Aggregating failures</a></li><li><a href="/features/3-12/rspec-expectations/composing-matchers/">Composing matchers</a></li><li><a href="/features/3-12/rspec-expectations/compound-expectations/">Compound expectations</a></li><li><a href="/features/3-12/rspec-expectations/define-negated-matcher/">Define negated matcher</a></li><li><a href="/features/3-12/rspec-expectations/customized-message/">Customized message</a></li><li><a href="/features/3-12/rspec-expectations/diffing/">Diffing</a></li><li><a href="/features/3-12/rspec-expectations/implicit-docstrings/">Implicit docstrings</a></li><li><a href="/features/3-12/rspec-expectations/syntax-configuration/">Syntax configuration</a></li><li><a href="/features/3-12/rspec-expectations/test-frameworks/">Test frameworks</a><ul><li><a href="/features/3-12/rspec-expectations/test-frameworks/minitest/"> Minitest integration</a></li></ul></li></ul></nav><article><h1>Composing Matchers</h1>

<p>RSpec&rsquo;s matchers are designed to be composable so that you can combine them to express
  the exact details of what you expect but nothing more. This can help you avoid writing
  over-specified brittle specs, by using a matcher in place of an exact value to specify only
  the essential aspects of what you expect.</p>

<p>The following matchers accept matchers as arguments:</p>
<div class="highlight"><pre class="highlight plaintext"><code>* `change { }.by(matcher)`
* `change { }.from(matcher).to(matcher)`
* `contain_exactly(matcher, matcher, matcher)`
* `end_with(matcher, matcher)`
* `include(matcher, matcher)`
* `include(:key =&gt; matcher, :other =&gt; matcher)`
* `match(arbitrary_nested_structure_with_matchers)`
* `output(matcher).to_stdout`
* `output(matcher).to_stderr`
* `raise_error(ErrorClass, matcher)`
* `start_with(matcher, matcher)`
* `throw_symbol(:sym, matcher)`
* `yield_with_args(matcher, matcher)`
* `yield_successive_args(matcher, matcher)`
</code></pre></div>
<p>Note that many built-in matchers do not accept matcher arguments because they have precise
  semantics that do not allow for a matcher argument. For example, <code>equal(some_object)</code> is
  designed to pass only if the actual and expected arguments are references to the same
  object. It would not make sense to support a matcher argument here.</p>

<p>All of RSpec&rsquo;s built-in matchers have one or more aliases that allow you to use a noun-phrase
  rather than verb form since they read better as composed arguments. They also provide
  customized failure output so that the failure message reads better as well.</p>

<p>A full list of these aliases is out of scope here, but here are some of the aliases used below:</p>
<div class="highlight"><pre class="highlight plaintext"><code>* `be &lt; 2` =&gt; `a_value &lt; 2`
* `be &gt; 2` =&gt; `a_value &gt; 2`
* `be_an_instance_of` =&gt; `an_instance_of`
* `be_within` =&gt; `a_value_within`
* `contain_exactly` =&gt; `a_collection_containing_exactly`
* `end_with` =&gt; `a_string_ending_with`, `ending_with`
* `match` =&gt; `a_string_matching`
* `start_with` =&gt; `a_string_starting_with`
</code></pre></div>
<p>For a full list, see the API docs for the <code>RSpec::Matchers</code> module.</p>

<h2>Composing matchers with <code>change</code></h2>

<p><em>Given</em> a file named &ldquo;change_spec.rb&rdquo; with:</p>
<div class="highlight"><pre class="highlight ruby"><code><span class="no">RSpec</span><span class="p">.</span><span class="nf">describe</span> <span class="s2">"Passing matchers to `change`"</span> <span class="k">do</span>
  <span class="n">specify</span> <span class="s2">"you can pass a matcher to `by`"</span> <span class="k">do</span>
    <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">expect</span> <span class="p">{</span> <span class="n">k</span> <span class="o">+=</span> <span class="mf">1.05</span> <span class="p">}.</span><span class="nf">to</span> <span class="n">change</span> <span class="p">{</span> <span class="n">k</span> <span class="p">}.</span>
      <span class="nf">by</span><span class="p">(</span> <span class="n">a_value_within</span><span class="p">(</span><span class="mf">0.1</span><span class="p">).</span><span class="nf">of</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">)</span>
  <span class="k">end</span>

  <span class="n">specify</span> <span class="s2">"you can pass matchers to `from` and `to`"</span> <span class="k">do</span>
    <span class="n">s</span> <span class="o">=</span> <span class="s2">"food"</span>
    <span class="n">expect</span> <span class="p">{</span> <span class="n">s</span> <span class="o">=</span> <span class="s2">"barn"</span> <span class="p">}.</span><span class="nf">to</span> <span class="n">change</span> <span class="p">{</span> <span class="n">s</span> <span class="p">}.</span>
      <span class="nf">from</span><span class="p">(</span> <span class="n">a_string_matching</span><span class="p">(</span><span class="sr">/foo/</span><span class="p">)</span> <span class="p">).</span>
      <span class="nf">to</span><span class="p">(</span> <span class="n">a_string_matching</span><span class="p">(</span><span class="sr">/bar/</span><span class="p">)</span> <span class="p">)</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div>
<p><em>When</em> I run <code>rspec change_spec.rb</code></p>

<p><em>Then</em> the examples should all pass.</p>

<h2>Composing matchers with <code>contain_exactly</code></h2>

<p><em>Given</em> a file named &ldquo;contain<em>exactly</em>spec.rb&rdquo; with:</p>
<div class="highlight"><pre class="highlight ruby"><code><span class="no">RSpec</span><span class="p">.</span><span class="nf">describe</span> <span class="s2">"Passing matchers to `contain_exactly`"</span> <span class="k">do</span>
  <span class="n">specify</span> <span class="s2">"you can pass matchers in place of exact values"</span> <span class="k">do</span>
    <span class="n">expect</span><span class="p">([</span><span class="s2">"barn"</span><span class="p">,</span> <span class="mf">2.45</span><span class="p">]).</span><span class="nf">to</span> <span class="n">contain_exactly</span><span class="p">(</span>
      <span class="n">a_value_within</span><span class="p">(</span><span class="mf">0.1</span><span class="p">).</span><span class="nf">of</span><span class="p">(</span><span class="mf">2.5</span><span class="p">),</span>
      <span class="n">a_string_starting_with</span><span class="p">(</span><span class="s2">"bar"</span><span class="p">)</span>
    <span class="p">)</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div>
<p><em>When</em> I run <code>rspec contain_exactly_spec.rb</code></p>

<p><em>Then</em> the examples should all pass.</p>

<h2>Composing matchers with <code>end_with</code></h2>

<p><em>Given</em> a file named &ldquo;end<em>with</em>spec.rb&rdquo; with:</p>
<div class="highlight"><pre class="highlight ruby"><code><span class="no">RSpec</span><span class="p">.</span><span class="nf">describe</span> <span class="s2">"Passing matchers to `end_with`"</span> <span class="k">do</span>
  <span class="n">specify</span> <span class="s2">"you can pass matchers in place of exact values"</span> <span class="k">do</span>
    <span class="n">expect</span><span class="p">([</span><span class="s2">"barn"</span><span class="p">,</span> <span class="s2">"food"</span><span class="p">,</span> <span class="mf">2.45</span><span class="p">]).</span><span class="nf">to</span> <span class="n">end_with</span><span class="p">(</span>
      <span class="n">a_string_matching</span><span class="p">(</span><span class="s2">"foo"</span><span class="p">),</span>
      <span class="n">a_value</span> <span class="o">&gt;</span> <span class="mi">2</span>
    <span class="p">)</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div>
<p><em>When</em> I run <code>rspec end_with_spec.rb</code></p>

<p><em>Then</em> the examples should all pass.</p>

<h2>Composing matchers with <code>include</code></h2>

<p><em>Given</em> a file named &ldquo;include_spec.rb&rdquo; with:</p>
<div class="highlight"><pre class="highlight ruby"><code><span class="no">RSpec</span><span class="p">.</span><span class="nf">describe</span> <span class="s2">"Passing matchers to `include`"</span> <span class="k">do</span>
  <span class="n">specify</span> <span class="s2">"you can use matchers in place of array values"</span> <span class="k">do</span>
    <span class="n">expect</span><span class="p">([</span><span class="s2">"barn"</span><span class="p">,</span> <span class="mf">2.45</span><span class="p">]).</span><span class="nf">to</span> <span class="kp">include</span><span class="p">(</span> <span class="n">a_string_starting_with</span><span class="p">(</span><span class="s2">"bar"</span><span class="p">)</span> <span class="p">)</span>
  <span class="k">end</span>

  <span class="n">specify</span> <span class="s2">"you can use matchers in place of hash values"</span> <span class="k">do</span>
    <span class="n">expect</span><span class="p">(</span><span class="ss">:a</span> <span class="o">=&gt;</span> <span class="s2">"food"</span><span class="p">,</span> <span class="ss">:b</span> <span class="o">=&gt;</span> <span class="s2">"good"</span><span class="p">).</span><span class="nf">to</span> <span class="kp">include</span><span class="p">(</span><span class="ss">:a</span> <span class="o">=&gt;</span> <span class="n">a_string_matching</span><span class="p">(</span><span class="sr">/foo/</span><span class="p">))</span>
  <span class="k">end</span>

  <span class="n">specify</span> <span class="s2">"you can use matchers in place of hash keys"</span> <span class="k">do</span>
    <span class="n">expect</span><span class="p">(</span><span class="s2">"food"</span> <span class="o">=&gt;</span> <span class="s2">"is good"</span><span class="p">).</span><span class="nf">to</span> <span class="kp">include</span><span class="p">(</span> <span class="n">a_string_matching</span><span class="p">(</span><span class="sr">/foo/</span><span class="p">)</span> <span class="p">)</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div>
<p><em>When</em> I run <code>rspec include_spec.rb</code></p>

<p><em>Then</em> the examples should all pass.</p>

<h2>Composing matchers with <code>match</code>:</h2>

<p><em>Given</em> a file named &ldquo;match_spec.rb&rdquo; with:</p>
<div class="highlight"><pre class="highlight ruby"><code><span class="no">RSpec</span><span class="p">.</span><span class="nf">describe</span> <span class="s2">"Passing matchers to `match`"</span> <span class="k">do</span>
  <span class="n">specify</span> <span class="s2">"you can match nested data structures against matchers"</span> <span class="k">do</span>
    <span class="nb">hash</span> <span class="o">=</span> <span class="p">{</span>
      <span class="ss">:a</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="ss">:b</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s2">"foo"</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">],</span>
        <span class="ss">:c</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="ss">:d</span> <span class="o">=&gt;</span> <span class="mf">2.05</span> <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>

    <span class="n">expect</span><span class="p">(</span><span class="nb">hash</span><span class="p">).</span><span class="nf">to</span> <span class="n">match</span><span class="p">(</span>
      <span class="ss">:a</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="ss">:b</span> <span class="o">=&gt;</span> <span class="n">a_collection_containing_exactly</span><span class="p">(</span>
          <span class="n">a_string_starting_with</span><span class="p">(</span><span class="s2">"f"</span><span class="p">),</span>
          <span class="n">an_instance_of</span><span class="p">(</span><span class="no">Float</span><span class="p">)</span>
        <span class="p">),</span>
        <span class="ss">:c</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="ss">:d</span> <span class="o">=&gt;</span> <span class="p">(</span><span class="n">a_value</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">)</span> <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">)</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div>
<p><em>When</em> I run <code>rspec match_spec.rb</code></p>

<p><em>Then</em> the examples should all pass.</p>

<h2>Composing matchers with <code>output</code></h2>

<p><em>Given</em> a file named &ldquo;output_spec.rb&rdquo; with:</p>
<div class="highlight"><pre class="highlight ruby"><code><span class="no">RSpec</span><span class="p">.</span><span class="nf">describe</span> <span class="s2">"Passing matchers to `output`"</span> <span class="k">do</span>
  <span class="n">specify</span> <span class="s2">"you can pass a matcher in place of the output (to_stdout)"</span> <span class="k">do</span>
    <span class="n">expect</span> <span class="p">{</span>
      <span class="nb">print</span> <span class="s1">'foo'</span>
    <span class="p">}.</span><span class="nf">to</span> <span class="n">output</span><span class="p">(</span><span class="n">a_string_starting_with</span><span class="p">(</span><span class="s1">'f'</span><span class="p">)).</span><span class="nf">to_stdout</span>
  <span class="k">end</span>
  <span class="n">specify</span> <span class="s2">"you can pass a matcher in place of the output (to_stderr)"</span> <span class="k">do</span>
    <span class="n">expect</span> <span class="p">{</span>
      <span class="nb">warn</span> <span class="s1">'foo'</span>
    <span class="p">}.</span><span class="nf">to</span> <span class="n">output</span><span class="p">(</span><span class="n">a_string_starting_with</span><span class="p">(</span><span class="s1">'f'</span><span class="p">)).</span><span class="nf">to_stderr</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div>
<p><em>When</em> I run <code>rspec output_spec.rb</code></p>

<p><em>Then</em> the examples should all pass.</p>

<h2>Composing matchers with <code>raise_error</code></h2>

<p><em>Given</em> a file named &ldquo;raise<em>error</em>spec.rb&rdquo; with:</p>
<div class="highlight"><pre class="highlight ruby"><code><span class="no">RSpec</span><span class="p">.</span><span class="nf">describe</span> <span class="s2">"Passing matchers to `raise_error`"</span> <span class="k">do</span>
  <span class="n">specify</span> <span class="s2">"you can pass a matcher in place of the message"</span> <span class="k">do</span>
    <span class="n">expect</span> <span class="p">{</span>
      <span class="k">raise</span> <span class="no">RuntimeError</span><span class="p">,</span> <span class="s2">"this goes boom"</span>
    <span class="p">}.</span><span class="nf">to</span> <span class="n">raise_error</span><span class="p">(</span><span class="no">RuntimeError</span><span class="p">,</span> <span class="n">a_string_ending_with</span><span class="p">(</span><span class="s2">"boom"</span><span class="p">))</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div>
<p><em>When</em> I run <code>rspec raise_error_spec.rb</code></p>

<p><em>Then</em> the examples should all pass.</p>

<h2>Composing matchers with <code>start_with</code></h2>

<p><em>Given</em> a file named &ldquo;start<em>with</em>spec.rb&rdquo; with:</p>
<div class="highlight"><pre class="highlight ruby"><code><span class="no">RSpec</span><span class="p">.</span><span class="nf">describe</span> <span class="s2">"Passing matchers to `start_with`"</span> <span class="k">do</span>
  <span class="n">specify</span> <span class="s2">"you can pass matchers in place of exact values"</span> <span class="k">do</span>
    <span class="n">expect</span><span class="p">([</span><span class="s2">"barn"</span><span class="p">,</span> <span class="s2">"food"</span><span class="p">,</span> <span class="mf">2.45</span><span class="p">]).</span><span class="nf">to</span> <span class="n">start_with</span><span class="p">(</span>
      <span class="n">a_string_matching</span><span class="p">(</span><span class="s2">"bar"</span><span class="p">),</span>
      <span class="n">a_string_matching</span><span class="p">(</span><span class="s2">"foo"</span><span class="p">)</span>
    <span class="p">)</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div>
<p><em>When</em> I run <code>rspec start_with_spec.rb</code></p>

<p><em>Then</em> the examples should all pass.</p>

<h2>Composing matchers with <code>throw_symbol</code></h2>

<p><em>Given</em> a file named &ldquo;throw<em>symbol</em>spec.rb&rdquo; with:</p>
<div class="highlight"><pre class="highlight ruby"><code><span class="no">RSpec</span><span class="p">.</span><span class="nf">describe</span> <span class="s2">"Passing matchers to `throw_symbol`"</span> <span class="k">do</span>
  <span class="n">specify</span> <span class="s2">"you can pass a matcher in place of a throw arg"</span> <span class="k">do</span>
    <span class="n">expect</span> <span class="p">{</span>
      <span class="kp">throw</span> <span class="ss">:pi</span><span class="p">,</span> <span class="no">Math</span><span class="o">::</span><span class="no">PI</span>
    <span class="p">}.</span><span class="nf">to</span> <span class="n">throw_symbol</span><span class="p">(</span><span class="ss">:pi</span><span class="p">,</span> <span class="n">a_value_within</span><span class="p">(</span><span class="mf">0.01</span><span class="p">).</span><span class="nf">of</span><span class="p">(</span><span class="mf">3.14</span><span class="p">))</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div>
<p><em>When</em> I run <code>rspec throw_symbol_spec.rb</code></p>

<p><em>Then</em> the examples should all pass.</p>

<h2>Composing matchers with <code>yield_with_args</code></h2>

<p><em>Given</em> a file named &ldquo;yield<em>with</em>args_spec.rb&rdquo; with:</p>
<div class="highlight"><pre class="highlight ruby"><code><span class="no">RSpec</span><span class="p">.</span><span class="nf">describe</span> <span class="s2">"Passing matchers to `yield_with_args`"</span> <span class="k">do</span>
  <span class="n">specify</span> <span class="s2">"you can pass matchers in place of the args"</span> <span class="k">do</span>
    <span class="n">expect</span> <span class="p">{</span> <span class="o">|</span><span class="n">probe</span><span class="o">|</span>
      <span class="s2">"food"</span><span class="p">.</span><span class="nf">tap</span><span class="p">(</span><span class="o">&amp;</span><span class="n">probe</span><span class="p">)</span>
    <span class="p">}.</span><span class="nf">to</span> <span class="n">yield_with_args</span><span class="p">(</span><span class="n">a_string_matching</span><span class="p">(</span><span class="sr">/foo/</span><span class="p">))</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div>
<p><em>When</em> I run <code>rspec yield_with_args_spec.rb</code></p>

<p><em>Then</em> the examples should all pass.</p>

<h2>Composing matchers with <code>yield_successive_args</code></h2>

<p><em>Given</em> a file named &ldquo;yield<em>successive</em>args_spec.rb&rdquo; with:</p>
<div class="highlight"><pre class="highlight ruby"><code><span class="no">RSpec</span><span class="p">.</span><span class="nf">describe</span> <span class="s2">"Passing matchers to `yield_successive_args`"</span> <span class="k">do</span>
  <span class="n">specify</span> <span class="s2">"you can pass matchers in place of the args"</span> <span class="k">do</span>
    <span class="n">expect</span> <span class="p">{</span> <span class="o">|</span><span class="n">probe</span><span class="o">|</span>
      <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">].</span><span class="nf">each</span><span class="p">(</span><span class="o">&amp;</span><span class="n">probe</span><span class="p">)</span>
    <span class="p">}.</span><span class="nf">to</span> <span class="n">yield_successive_args</span><span class="p">(</span><span class="n">a_value</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">a_value</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">)</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div>
<p><em>When</em> I run <code>rspec yield_successive_args_spec.rb</code></p>

<p><em>Then</em> the examples should all pass.</p>

<h2>Composing matchers using a compound <code>and</code> expression</h2>

<p><em>Given</em> a file named &ldquo;include_spec.rb&rdquo; with:</p>
<div class="highlight"><pre class="highlight ruby"><code><span class="no">RSpec</span><span class="p">.</span><span class="nf">describe</span> <span class="s2">"Passing a compound matcher expression to `include`"</span> <span class="k">do</span>
  <span class="n">example</span> <span class="k">do</span>
    <span class="n">expect</span><span class="p">([</span><span class="s2">"food"</span><span class="p">,</span> <span class="s2">"drink"</span><span class="p">]).</span><span class="nf">to</span> <span class="kp">include</span><span class="p">(</span> <span class="n">a_string_starting_with</span><span class="p">(</span><span class="s2">"f"</span><span class="p">).</span><span class="nf">and</span> <span class="n">ending_with</span><span class="p">(</span><span class="s2">"d"</span><span class="p">))</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div>
<p><em>When</em> I run <code>rspec include_spec.rb</code></p>

<p><em>Then</em> the examples should all pass.</p>
</article></section><footer><div>Created with the assistance of Ninefold<img src="/images/brutus-half.png" alt="Brutus" /></div><br /><a href="https://dnsimple.link/resolving-rspec" target="_blank">Resolving with<br /><img src="https://cdn.dnsimple.com/assets/resolving-with-us/logo-dark.png" alt="DNSimple" style="width:100px;" /></a></footer></body><script src="/javascripts/asciinema-player.js"></script></html>