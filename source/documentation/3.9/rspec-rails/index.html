<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>
  File: README
  
    &mdash; Documentation by YARD 0.9.24
  
</title>

  <link rel="stylesheet" href="/documentation/3.9/rspec-rails/css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="/documentation/3.9/rspec-rails/css/common.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="/documentation/3.9/rspec-rails/css/rspec.css" type="text/css" charset="utf-8" />

<script type="text/javascript">
  pathId = "README";
  relpath = '';
</script>


  <script type="text/javascript" charset="utf-8" src="/documentation/3.9/rspec-rails/js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="/documentation/3.9/rspec-rails/js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="_index.html">Index</a> &raquo; 
    <span class="title">File: README</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><div id='filecontents'>
<h1 id="label-rspec-rails+rdoc-image-3Ahttps-3A-2F-2Fsecure.travis-ci.org-2Frspec-2Frspec-rails.svg-3Fbranch-3Dmaster+rdoc-image-3Ahttps-3A-2F-2Fcodeclimate.com-2Fgithub-2Frspec-2Frspec-rails.svg+rdoc-image-3Ahttps-3A-2F-2Fbadge.fury.io-2Frb-2Frspec-rails.svg">rspec-rails <a href="https://travis-ci.org/rspec/rspec-rails"><img src="https://secure.travis-ci.org/rspec/rspec-rails.svg?branch=master"></a> <a href="https://codeclimate.com/github/rspec/rspec-rails"><img src="https://codeclimate.com/github/rspec/rspec-rails.svg"></a> <a href="gem-version"><img src="https://badge.fury.io/rb/rspec-rails.svg"></a></h1>

<p><code>rspec-rails</code> brings the <a href="https://rspec.info/">RSpec</a> testing framework to <a href="https://rubyonrails.org/">Ruby on Rails</a> as a drop-in alternative to its default testing framework, Minitest.</p>

<p>In RSpec, tests are not just scripts that verify your application code. They’re also specifications (or <em>specs,</em> for short): detailed explanations of how the application is supposed to behave, expressed in plain English.</p>

<p>Use <strong><a href="https://github.com/dchelimsky/rspec-rails">rspec-rails 1.x</a></strong> for Rails 2.x.</p>

<h2 id="label-Installation">Installation</h2>
<ol><li>
<p>Add <code>rspec-rails</code> to <strong>both</strong> the <code>:development</code> and <code>:test</code> groups  of your app’s <code>Gemfile</code>:</p>
</li></ol>

<p>“`ruby  # Run against the latest stable release  group :development, :test do  gem &#39;rspec-rails&#39;, &#39;~&gt; 3.9&#39;  end</p>

<p># Or, run against the master branch  # (requires master-branch versions of all related RSpec libraries)  group :development, :test do  %w[rspec-core rspec-expectations rspec-mocks rspec-rails rspec-support].each do |lib|  gem lib, :git =&gt; “<a href="https://github.com/rspec/#lib.git">github.com/rspec/#lib.git</a>”, :branch =&gt; &#39;master&#39;  end  end  “`</p>

<p>(Adding it to the <code>:development</code> group is not strictly necessary,  but without it, generators and rake tasks must be preceded by <code>RAILS_ENV=test</code>.)</p>
<ol><li>
<p>Then, in your project directory:</p>
</li></ol>

<p>“`sh  # Download and install  $ bundle install</p>

<p># Generate boilerplate configuration files  # (check the comments in each generated file for more information)  $ rails generate rspec:install  create .rspec  create spec  create spec/spec_helper.rb  create spec/rails_helper.rb  “`</p>

<h2 id="label-Upgrading">Upgrading</h2>

<p>If your project is already using an older version of <code>rspec-rails</code>, upgrade to the latest version with:</p>

<pre class="code ruby"><code class="ruby">$ bundle update rspec-rails
</code></pre>

<p>RSpec follows <a href="https://semver.org/">semantic versioning</a>, which means that “major version” upgrades (<em>e.g.,</em> 2.x → 3.x) come with <strong>breaking changes</strong>. If you’re upgrading from version 2.x or below, read the <a href="https://www.relishapp.com/rspec/rspec-rails/docs/upgrade">rspec-rails upgrade notes</a> to find out what to watch out for.</p>

<p>Be sure to check the general <a href="https://relishapp.com/rspec/docs/upgrade">RSpec upgrade notes</a> as well.</p>

<h2 id="label-Usage">Usage</h2>

<h3 id="label-Creating+boilerplate+specs+with+rails+generate">Creating boilerplate specs with <code>rails generate</code></h3>

<pre class="code ruby"><code class="ruby"># RSpec hooks into built-in generators
$ rails generate model user
      invoke  active_record
      create    db/migrate/20181017040312_create_users.rb
      create    app/models/user.rb
      invoke    rspec
      create      spec/models/user_spec.rb

# RSpec also provides its own spec file generators
$ rails generate rspec:model user
      create  spec/models/user_spec.rb

# List all RSpec generators
$ rails generate --help | grep rspec
</code></pre>

<h3 id="label-Running+specs">Running specs</h3>

<pre class="code ruby"><code class="ruby"># Default: Run all spec files (i.e., those matching spec/**/*_spec.rb)
$ bundle exec rspec

# Run all spec files in a single directory (recursively)
$ bundle exec rspec spec/models

# Run a single spec file
$ bundle exec rspec spec/controllers/accounts_controller_spec.rb

# Run a single example from a spec file (by line number)
$ bundle exec rspec spec/controllers/accounts_controller_spec.rb:8

# See all options for running specs
$ bundle exec rspec --help
</code></pre>

<p><strong>Optional:</strong> If <code>bundle exec rspec</code> is too verbose for you, you can generate a binstub at <code>bin/rspec</code> and use that instead (Rails 4+ only):</p>

<p><code>sh  $ bundle binstubs rspec-core </code></p>

<h2 id="label-RSpec+DSL+Basics+-28or-2C+how+do+I+write+a+spec-3F-29">RSpec DSL Basics (or, how do I write a spec?)</h2>

<p>In RSpec, application behavior is described <strong>first in (almost) plain English, then again in test code</strong>, like so:</p>

<pre class="code ruby"><code class="ruby"><span class='const'><span class='object_link'><a href="RSpec.html" title="RSpec (module)">RSpec</a></span></span><span class='period'>.</span><span class='id identifier rubyid_describe'>describe</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Post</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>do</span>           <span class='comment'>#
</span>  <span class='id identifier rubyid_context'>context</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>before publication</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>do</span>  <span class='comment'># (almost) plain English
</span>    <span class='id identifier rubyid_it'>it</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>cannot have comments</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>do</span>   <span class='comment'>#
</span>      <span class='id identifier rubyid_expect'>expect</span> <span class='lbrace'>{</span> <span class='const'>Post</span><span class='period'>.</span><span class='id identifier rubyid_create'>create</span><span class='period'>.</span><span class='id identifier rubyid_comments'>comments</span><span class='period'>.</span><span class='id identifier rubyid_create!'>create!</span> <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_raise_error'>raise_error</span><span class='lparen'>(</span><span class='const'>ActiveRecord</span><span class='op'>::</span><span class='const'>RecordInvalid</span><span class='rparen'>)</span>  <span class='comment'># test code
</span>    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</code></pre>

<p>Running <code>rspec</code> will execute this test code, and then use the plain-English descriptions to generate a report of where the application conforms to (or fails to meet) the spec:</p>

<pre class="code ruby"><code class="ruby">$ rspec --format documentation spec/models/post_spec.rb

Post
  before publication
    cannot have comments

Failures:

  1) Post before publication cannot have comments
     Failure/Error: expect { Post.create.comments.create! }.to raise_error(ActiveRecord::RecordInvalid)
       expected ActiveRecord::RecordInvalid but nothing was raised
     # ./spec/models/post.rb:4:in `block (3 levels) in &lt;top (required)&gt;&#39;

Finished in 0.00527 seconds (files took 0.29657 seconds to load)
1 example, 1 failure

Failed examples:

rspec ./spec/models/post_spec.rb:3 # Post before publication cannot have comments
</code></pre>

<p>For an in-depth look at the RSpec DSL, including lots of examples, read the official Cucumber documentation for <a href="https://relishapp.com/rspec/rspec-core/docs">RSpec Core</a>.</p>

<h3 id="label-Helpful+Rails+Matchers">Helpful Rails Matchers</h3>

<p>In RSpec, assertions are called <em>expectations,</em> and every expectation is built around a <em>matcher.</em> When you <code>expect(a).to eq(b)</code>, you’re using the <code>eq</code> matcher.</p>

<p>In addition to <a href="https://relishapp.com/rspec/rspec-expectations/docs/built-in-matchers">the matchers that come standard in RSpec</a>, here are some extras that make it easier to test the various parts of a Rails system:</p>

<p>| RSpec matcher | Delegates to | Available in | Notes | | ———————— | —————– | ——————————- | ——————————————————– | | <a href="https://relishapp.com/rspec/rspec-rails/docs/matchers/be-a-new-matcher">be_a_new</a> | | all | primarily intended for controller specs | | <a href="https://relishapp.com/rspec/rspec-rails/docs/matchers/render-template-matcher">render_template</a> | <code>assert_template</code> | request / controller / view | use with <code>expect(response).to</code> | | <a href="https://relishapp.com/rspec/rspec-rails/docs/matchers/redirect-to-matcher">redirect_to</a> | <code>assert_redirect</code> | request / controller | use with <code>expect(response).to</code> | | <a href="https://relishapp.com/rspec/rspec-rails/docs/routing-specs/route-to-matcher">route_to</a> | <code>assert_routing</code> | routing / controller | replaces <code>route_for</code> from version 1.x | | <a href="https://relishapp.com/rspec/rspec-rails/docs/routing-specs/be-routable-matcher">be_routable</a> | | routing / controller | usu. for <code>expect(...).not_to be_routable</code> | | <a href="https://relishapp.com/rspec/rspec-rails/docs/matchers/have-http-status-matcher">have_http_status</a> | | request / controller / feature | | | <a href="https://relishapp.com/rspec/rspec-rails/docs/matchers/activerecord-relation-match-array">match_array</a> | | all | for comparing arrays of ActiveRecord objects | | <a href="https://relishapp.com/rspec/rspec-rails/docs/matchers/have-been-enqueued-matcher">have_been_enqueued</a> | | all | requires config: <code>ActiveJob::Base.queue_adapter = :test</code> | | <a href="https://relishapp.com/rspec/rspec-rails/docs/matchers/have-enqueued-job-matcher">have_enqueued_job</a> | | all | requires config: <code>ActiveJob::Base.queue_adapter = :test</code> |</p>

<p>Follow the links above for examples of how each matcher is used.</p>

<h3 id="label-What+else+does+RSpec+Rails+add-3F">What else does RSpec Rails add?</h3>

<p>For a comprehensive look at RSpec Rails’ features, read the <a href="https://relishapp.com/rspec/rspec-rails/docs">official Cucumber documentation</a>.</p>

<h2 id="label-What+tests+should+I+write-3F">What tests should I write?</h2>

<p>RSpec Rails defines ten different <em>types</em> of specs for testing different parts of a typical Rails application. Each one inherits from one of Rails’ built-in <code>TestCase</code> classes, meaning the helper methods provided by default in Rails tests are available in RSpec, as well.</p>

<p>| Spec type | Corresponding Rails test class |  | ————– | ——————————– |  | <a href="https://www.relishapp.com/rspec/rspec-rails/docs/model-specs">model</a> | |  | <a href="https://www.relishapp.com/rspec/rspec-rails/docs/controller-specs">controller</a> | <a href="https://api.rubyonrails.org/classes/ActionController/TestCase.html">ActionController::TestCase</a> |  | <a href="https://relishapp.com/rspec/rspec-rails/docs/mailer-specs">mailer</a> | <code>ActionMailer::TestCase</code> |  | <a href="https://relishapp.com/rspec/rspec-rails/docs/job-specs/job-spec">job</a> | |  | <a href="https://www.relishapp.com/rspec/rspec-rails/docs/view-specs/view-spec">view</a> | <code>ActionView::TestCase</code> |  | <a href="https://www.relishapp.com/rspec/rspec-rails/docs/routing-specs">routing</a> | |  | <a href="https://www.relishapp.com/rspec/rspec-rails/docs/helper-specs/helper-spec">helper</a> | <code>ActionView::TestCase</code> |  | <a href="https://relishapp.com/rspec/rspec-rails/docs/request-specs/request-spec">request</a> | <a href="https://api.rubyonrails.org/classes/ActionDispatch/IntegrationTest.html">ActionDispatch::IntegrationTest</a> |  | <a href="https://www.relishapp.com/rspec/rspec-rails/docs/feature-specs/feature-spec">feature</a> | |  | <a href="https://relishapp.com/rspec/rspec-rails/docs/system-specs/system-spec">system</a> | <a href="https://api.rubyonrails.org/classes/ActionDispatch/SystemTestCase.html">ActionDispatch::SystemTestCase</a> |</p>

<p>Follow the links above to see examples of each spec type, or for official Rails API documentation on the given <code>TestCase</code> class.</p>

<blockquote>
<p><strong>Note: This is not a checklist.</strong></p>

<p>Ask a hundred developers how to test an application, and you’ll get a hundred different answers.</p>

<p>RSpec Rails provides thoughtfully selected features to encourage good testing practices, but there’s no “right” way to do it. Ultimately, it’s up to you to decide how your test suite will be composed.</p>
</blockquote>

<p>When creating a spec file, assign it a type in the top-level <code>describe</code> block, like so:</p>

<pre class="code ruby"><code class="ruby"># spec/models/user_spec.rb

RSpec.describe User, type: :model do
...
</code></pre>

<h3 id="label-System+specs-2C+feature+specs-2C+request+specs-E2-80-93what-E2-80-99s+the+difference-3F">System specs, feature specs, request specs–what’s the difference?</h3>

<p>RSpec Rails provides some end-to-end (entire application) testing capability to specify the interaction with the client.</p>

<h4 id="label-System+specs">System specs</h4>

<p>Also called <strong>acceptance tests</strong>, <strong>browser tests</strong>, or <strong>end-to-end tests</strong>, system specs test the application from the perspective of a <em>human client.</em> The test code walks through a user’s browser interactions,</p>
<ul><li>
<p><code>visit &#39;/login&#39;</code></p>
</li><li>
<p><code>fill_in &#39;Name&#39;, with: &#39;jdoe&#39;</code></p>
</li></ul>

<p>and the expectations revolve around page content.</p>
<ul><li>
<p><code>expect(page).to have_text(&#39;Welcome&#39;)</code></p>
</li></ul>

<p>Because system specs are a wrapper around Rails’ built-in <code>SystemTestCase</code>, they’re only available on Rails 5.1+. (Feature specs serve the same purpose, but without this dependency.)</p>

<h4 id="label-Feature+specs">Feature specs</h4>

<p>Before Rails introduced system testing facilities, feature specs were the only spec type for end-to-end testing. While the RSpec team now <a href="https://rspec.info/blog/2017/10/rspec-3-7-has-been-released/#rails-actiondispatchsystemtest-integration-system-specs">officially recommends system specs</a> instead, feature specs are still fully supported, look basically identical, and work on older versions of Rails.</p>

<p>On the other hand, feature specs require non-trivial configuration to get some important features working, like JavaScript testing or making sure each test runs with a fresh DB state. With system specs, this configuration is provided out-of-the-box.</p>

<p>Like system specs, feature specs require the <a href="https://github.com/teamcapybara/capybara">Capybara</a> gem. Rails 5.1+ includes it by default as part of system tests, but if you don’t have the luxury of upgrading, be sure to add it to the <code>:test</code> group of your <code>Gemfile</code> first:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_group'>group</span> <span class='symbol'>:test</span> <span class='kw'>do</span>
  <span class='id identifier rubyid_gem'>gem</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>capybara</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span>
</code></pre>

<h4 id="label-Request+specs">Request specs</h4>

<p>Request specs are for testing the application from the perspective of a <em>machine client.</em> They begin with an HTTP request and end with the HTTP response, so they’re faster than feature specs, but do not examine your app’s UI or JavaScript.</p>

<p>Request specs provide a high-level alternative to controller specs. In fact, as of RSpec 3.5, both the Rails and RSpec teams <a href="https://rspec.info/blog/2016/07/rspec-3-5-has-been-released/#rails-support-for-rails-5">discourage directly testing controllers</a> in favor of functional tests like request specs.</p>

<p>When writing them, try to answer the question, “For a given HTTP request (verb + path + parameters), what HTTP response should the application return?”</p>

<h2 id="label-Contributing">Contributing</h2>
<ul><li>
<p><a href="BUILD_DETAIL.md">Build details</a></p>
</li><li>
<p><a href="CODE_OF_CONDUCT.md">Code of Conduct</a></p>
</li><li>
<p><a href="CONTRIBUTING.md">Detailed contributing guide</a></p>
</li></ul>

<p>Once you’ve cloned the repo and <a href="DEVELOPMENT.md">set up the environment</a>, you can run the specs and Cucumber features, or submit a pull request.</p>

<h2 id="label-See+Also">See Also</h2>

<h3 id="label-RSpec+base+libraries">RSpec base libraries</h3>
<ul><li>
<p><a href="https://github.com/rspec/rspec">github.com/rspec/rspec</a></p>
</li><li>
<p><a href="https://github.com/rspec/rspec-core">github.com/rspec/rspec-core</a></p>
</li><li>
<p><a href="https://github.com/rspec/rspec-expectations">github.com/rspec/rspec-expectations</a></p>
</li><li>
<p><a href="https://github.com/rspec/rspec-mocks">github.com/rspec/rspec-mocks</a></p>
</li></ul>

<h3 id="label-Recommended+third-party+extensions">Recommended third-party extensions</h3>
<ul><li>
<p><a href="https://github.com/thoughtbot/factory_bot">FactoryBot</a></p>
</li><li>
<p><a href="https://github.com/jnicklas/capybara">Capybara</a>  (Included by default in Rails 5.1+.  Note that <a href="https://rubydoc.info/gems/rspec-rails/file/Capybara.md">additional configuration is required</a> to use the Capybara DSL  anywhere other than system specs and feature specs.)</p>
</li></ul>
</div></div>

      <div id="footer">
  Generated on Wed Jan 29 15:53:18 2020 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.24 (ruby-2.7.0).
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59095215-1', 'auto');
  ga('send', 'pageview');

</script>

    </div>
  </body>
</html>
